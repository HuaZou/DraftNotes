<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 17 XGBoost Algorithm | 生物信息随记</title>
<meta name="author" content="Hua Zou">
<meta name="description" content="The XGBoost or Extreme Gradient Boosting algorithm is a decision tree based machine learning algorithm which uses a process called boosting to help improve performance. The basic classification...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 17 XGBoost Algorithm | 生物信息随记">
<meta property="og:type" content="book">
<meta property="og:url" content="https://zouhua.top/DraftNotes/XGBoostalgorithm.html">
<meta property="og:description" content="The XGBoost or Extreme Gradient Boosting algorithm is a decision tree based machine learning algorithm which uses a process called boosting to help improve performance. The basic classification...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 17 XGBoost Algorithm | 生物信息随记">
<meta name="twitter:description" content="The XGBoost or Extreme Gradient Boosting algorithm is a decision tree based machine learning algorithm which uses a process called boosting to help improve performance. The basic classification...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Poppins-0.4.8/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.31/datatables.js"></script><link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="assets/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">生物信息随记</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> 介绍</a></li>
<li class="book-part">Data Set</li>
<li><a class="" href="ZeybelDataset.html"><span class="header-section-number">2</span> Zeybel Dataset</a></li>
<li class="book-part">Statistical Methods</li>
<li><a class="" href="GEEandMLM.html"><span class="header-section-number">3</span> GEE and MLM</a></li>
<li><a class="" href="HypothesisTestingMethods.html"><span class="header-section-number">4</span> Hypothesis Testing Methods</a></li>
<li><a class="" href="BatchEffectCorrection.html"><span class="header-section-number">5</span> Batch Effect Correction</a></li>
<li><a class="" href="LinearModelonMicrobialCommunity.html"><span class="header-section-number">6</span> Linear Model on Microbial Community</a></li>
<li><a class="" href="PermutationTest.html"><span class="header-section-number">7</span> Permutation Test</a></li>
<li><a class="" href="SurvivalAnalysis.html"><span class="header-section-number">8</span> Survival Analysis</a></li>
<li class="book-part">Metabolomics Data Analysis</li>
<li><a class="" href="dataprocessing.html"><span class="header-section-number">9</span> Data Processing</a></li>
<li><a class="" href="DimensionReduction.html"><span class="header-section-number">10</span> Dimension Reduction</a></li>
<li><a class="" href="DifferetialAnalysis.html"><span class="header-section-number">11</span> Differetial Analysis</a></li>
<li><a class="" href="FunctionalAnalysis.html"><span class="header-section-number">12</span> Functional Analysis</a></li>
<li><a class="" href="MetOriginAnalysis.html"><span class="header-section-number">13</span> MetOrigin Analysis</a></li>
<li><a class="" href="OtherAnalysis.html"><span class="header-section-number">14</span> Other Analysis</a></li>
<li class="book-part">Metagenomics Data Analysis</li>
<li><a class="" href="MultipleDifferetialAnalysis.html"><span class="header-section-number">15</span> Multiple Differetial Analysis</a></li>
<li class="book-part">Machine Learning</li>
<li><a class="" href="randomforestalgorithm.html"><span class="header-section-number">16</span> Random Forest Algorithm</a></li>
<li><a class="active" href="XGBoostalgorithm.html"><span class="header-section-number">17</span> XGBoost Algorithm</a></li>
<li class="book-part">Knowledge</li>
<li><a class="" href="Metageomics.html"><span class="header-section-number">18</span> Metageomics</a></li>
<li><a class="" href="Notes.html"><span class="header-section-number">19</span> Notes</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/HuaZou/DraftNotes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="XGBoostalgorithm" class="section level1" number="17">
<h1>
<span class="header-section-number">17</span> XGBoost Algorithm<a class="anchor" aria-label="anchor" href="#XGBoostalgorithm"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>The XGBoost or Extreme Gradient Boosting algorithm is a decision tree based machine learning algorithm which uses a process called boosting to help improve performance.</p>
<p>The basic classification modeling process involves obtaining a dataset, creating features of independent variables, and using them to predict a dependent variable or target class. Most classification datasets require some preparation before they can be used by classifiers, and also usually require the creation of additional features through a process called feature engineering.</p>
<p>“Gradient boosting is a machine learning technique for regression, classification and other tasks, which produces a prediction model in the form of an ensemble of weak prediction models, typically decision trees. When a decision tree is the weak learner, the resulting algorithm is called gradient boosted trees, which usually outperforms random forest. It builds the model in a stage-wise fashion like other boosting methods do, and it generalizes them by allowing optimization of an arbitrary differentiable loss function” Note: XGBoost is ditinguished from other gradient boosting techniques by its regularization mechanism to prevent overfitting.</p>
</blockquote>
<div id="data-preparation" class="section level3" number="17.0.1">
<h3>
<span class="header-section-number">17.0.1</span> Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<strong>data table</strong>: <code>clean_data.csv</code> with group information (Row-&gt;samples;Column-&gt;features)</li>
</ul>
<p>可以点击此处下载数据<a href="https://github.com/HuaZou/DraftNotes/blob/main/InputData/Breast_cancer/clean_data.csv">clean_data.csv</a>或使用<code>wget</code></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb245-1"><a href="XGBoostalgorithm.html#cb245-1" tabindex="-1"></a><span class="fu">wget</span> https://github.com/HuaZou/DraftNotes/blob/main/InputData/Breast_cancer/clean_data.csv</span></code></pre></div>
<blockquote>
<p>该数据集包含569份恶性和良性肿瘤的样本的32类指标，通过这些特征构建区分恶性和良性肿瘤的随机森林分类器.</p>
</blockquote>
<blockquote>
<p>The Breast Cancer datasets is available machine learning repository maintained by the University of California, Irvine. The dataset contains 569 samples of malignant and benign tumor cells.</p>
</blockquote>
</div>
<div id="data-description" class="section level3" number="17.0.2">
<h3>
<span class="header-section-number">17.0.2</span> Data Description<a class="anchor" aria-label="anchor" href="#data-description"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p><strong>Feature table</strong>:</p>
<ul>
<li>M samples x N Features</li>
</ul>
</li>
<li>
<p><strong>metadata</strong></p>
<ul>
<li>main response/independent variable: <code>diagnosis: M vs B</code>
</li>
</ul>
</li>
</ul>
</div>
<div id="data-preprocessing" class="section level3" number="17.0.3">
<h3>
<span class="header-section-number">17.0.3</span> Data Preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<strong>Prevalence filtering</strong>: reducing the sparsity of data (default: 10%)</li>
</ul>
</div>
<div id="data-partition" class="section level3" number="17.0.4">
<h3>
<span class="header-section-number">17.0.4</span> Data Partition<a class="anchor" aria-label="anchor" href="#data-partition"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>train dataset: 80% or 70% (default 70%);</li>
<li>test dataset: 20% or 30% (default 30%).</li>
</ul>
</div>
<div id="feature-selection" class="section level3" number="17.0.5">
<h3>
<span class="header-section-number">17.0.5</span> Feature Selection<a class="anchor" aria-label="anchor" href="#feature-selection"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Importance of features by random forest;</li>
</ul>
<p>Feature selection should be taken only in training set, which avoiding overfitting.</p>
</div>
<div id="model-training" class="section level3" number="17.0.6">
<h3>
<span class="header-section-number">17.0.6</span> Model training<a class="anchor" aria-label="anchor" href="#model-training"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Base model construction with higher performance</li>
<li>Tuning the hyperparameters</li>
<li>Best model building and evaluations</li>
</ul>
</div>
<div id="python-environment" class="section level3" number="17.0.7">
<h3>
<span class="header-section-number">17.0.7</span> python environment<a class="anchor" aria-label="anchor" href="#python-environment"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># myenvs &lt;- conda_list()</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># envname &lt;- myenvs$name[2]</span></span>
<span><span class="co"># use_condaenv(envname, required = TRUE)</span></span>
<span><span class="co"># # or</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html">use_condaenv</a></span><span class="op">(</span><span class="st">"base"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="loading-required-packages" class="section level2" number="17.1">
<h2>
<span class="header-section-number">17.1</span> Loading required packages<a class="anchor" aria-label="anchor" href="#loading-required-packages"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb247"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb247-1"><a href="XGBoostalgorithm.html#cb247-1" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb247-2"><a href="XGBoostalgorithm.html#cb247-2" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb247-3"><a href="XGBoostalgorithm.html#cb247-3" tabindex="-1"></a></span>
<span id="cb247-4"><a href="XGBoostalgorithm.html#cb247-4" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb247-5"><a href="XGBoostalgorithm.html#cb247-5" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb247-6"><a href="XGBoostalgorithm.html#cb247-6" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb247-7"><a href="XGBoostalgorithm.html#cb247-7" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb247-8"><a href="XGBoostalgorithm.html#cb247-8" tabindex="-1"></a></span>
<span id="cb247-9"><a href="XGBoostalgorithm.html#cb247-9" tabindex="-1"></a><span class="co"># machine learning</span></span>
<span id="cb247-10"><a href="XGBoostalgorithm.html#cb247-10" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb247-11"><a href="XGBoostalgorithm.html#cb247-11" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb247-12"><a href="XGBoostalgorithm.html#cb247-12" tabindex="-1"></a></span>
<span id="cb247-13"><a href="XGBoostalgorithm.html#cb247-13" tabindex="-1"></a><span class="co">#from xgboost import XGBClassifier</span></span>
<span id="cb247-14"><a href="XGBoostalgorithm.html#cb247-14" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb247-15"><a href="XGBoostalgorithm.html#cb247-15" tabindex="-1"></a></span>
<span id="cb247-16"><a href="XGBoostalgorithm.html#cb247-16" tabindex="-1"></a><span class="co">#classes for grid search and cross-validation, function for splitting data and evaluating models</span></span>
<span id="cb247-17"><a href="XGBoostalgorithm.html#cb247-17" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb247-18"><a href="XGBoostalgorithm.html#cb247-18" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score</span>
<span id="cb247-19"><a href="XGBoostalgorithm.html#cb247-19" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb247-20"><a href="XGBoostalgorithm.html#cb247-20" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, auc</span>
<span id="cb247-21"><a href="XGBoostalgorithm.html#cb247-21" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix </span>
<span id="cb247-22"><a href="XGBoostalgorithm.html#cb247-22" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb247-23"><a href="XGBoostalgorithm.html#cb247-23" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb247-24"><a href="XGBoostalgorithm.html#cb247-24" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb247-25"><a href="XGBoostalgorithm.html#cb247-25" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb247-26"><a href="XGBoostalgorithm.html#cb247-26" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV, RandomizedSearchCV</span>
<span id="cb247-27"><a href="XGBoostalgorithm.html#cb247-27" tabindex="-1"></a><span class="im">from</span> skopt <span class="im">import</span> BayesSearchCV</span>
<span id="cb247-28"><a href="XGBoostalgorithm.html#cb247-28" tabindex="-1"></a></span>
<span id="cb247-29"><a href="XGBoostalgorithm.html#cb247-29" tabindex="-1"></a><span class="co"># plotting </span></span>
<span id="cb247-30"><a href="XGBoostalgorithm.html#cb247-30" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb247-31"><a href="XGBoostalgorithm.html#cb247-31" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb247-32"><a href="XGBoostalgorithm.html#cb247-32" tabindex="-1"></a></span>
<span id="cb247-33"><a href="XGBoostalgorithm.html#cb247-33" tabindex="-1"></a>plt.style.use(<span class="st">'fivethirtyeight'</span>)</span>
<span id="cb247-34"><a href="XGBoostalgorithm.html#cb247-34" tabindex="-1"></a>sns.set_style(<span class="st">"darkgrid"</span>)</span>
<span id="cb247-35"><a href="XGBoostalgorithm.html#cb247-35" tabindex="-1"></a></span>
<span id="cb247-36"><a href="XGBoostalgorithm.html#cb247-36" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">4</span>)</span>
<span id="cb247-37"><a href="XGBoostalgorithm.html#cb247-37" tabindex="-1"></a>plt.rcParams[<span class="st">"axes.linewidth"</span>] <span class="op">=</span> <span class="dv">1</span></span></code></pre></div>
</div>
<div id="data-preparation-1" class="section level2" number="17.2">
<h2>
<span class="header-section-number">17.2</span> Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation-1"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>The Breast Cancer datasets is available machine learning repository maintained by the University of California, Irvine. The dataset contains 569 samples of malignant and benign tumor cells.
The first two columns in the dataset store the unique ID numbers of the samples and the corresponding diagnosis (M=malignant, B=benign), respectively.
The columns 3-32 contain 30 real-value features that have been computed from digitized images of the cell nuclei, which can be used to build a model to predict whether a tumor is benign or malignant.</p>
</blockquote>
<div class="sourceCode" id="cb248"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb248-1"><a href="XGBoostalgorithm.html#cb248-1" tabindex="-1"></a>dat <span class="op">=</span> pd.read_csv(<span class="st">"InputData/Breast_cancer/clean_data.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb248-2"><a href="XGBoostalgorithm.html#cb248-2" tabindex="-1"></a></span>
<span id="cb248-3"><a href="XGBoostalgorithm.html#cb248-3" tabindex="-1"></a>dat.head()</span>
<span id="cb248-4"><a href="XGBoostalgorithm.html#cb248-4" tabindex="-1"></a><span class="co">#&gt;   diagnosis  radius_mean  ...  symmetry_worst  fractal_dimension_worst</span></span>
<span id="cb248-5"><a href="XGBoostalgorithm.html#cb248-5" tabindex="-1"></a><span class="co">#&gt; 0         M        17.99  ...          0.4601                  0.11890</span></span>
<span id="cb248-6"><a href="XGBoostalgorithm.html#cb248-6" tabindex="-1"></a><span class="co">#&gt; 1         M        20.57  ...          0.2750                  0.08902</span></span>
<span id="cb248-7"><a href="XGBoostalgorithm.html#cb248-7" tabindex="-1"></a><span class="co">#&gt; 2         M        19.69  ...          0.3613                  0.08758</span></span>
<span id="cb248-8"><a href="XGBoostalgorithm.html#cb248-8" tabindex="-1"></a><span class="co">#&gt; 3         M        11.42  ...          0.6638                  0.17300</span></span>
<span id="cb248-9"><a href="XGBoostalgorithm.html#cb248-9" tabindex="-1"></a><span class="co">#&gt; 4         M        20.29  ...          0.2364                  0.07678</span></span>
<span id="cb248-10"><a href="XGBoostalgorithm.html#cb248-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb248-11"><a href="XGBoostalgorithm.html#cb248-11" tabindex="-1"></a><span class="co">#&gt; [5 rows x 31 columns]</span></span></code></pre></div>
</div>
<div id="xgboost-classification" class="section level2" number="17.3">
<h2>
<span class="header-section-number">17.3</span> XGBoost classification<a class="anchor" aria-label="anchor" href="#xgboost-classification"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Transforming group label</p></li>
<li><p>Principal component analysis</p></li>
<li><p>Data partition</p></li>
<li><p>Feaeture selection</p></li>
<li><p>Base model</p></li>
<li><p>Tuning hyperparameters</p></li>
<li><p>Building final model</p></li>
<li><p>Evaluating model performance</p></li>
</ul>
<div id="transforming-label" class="section level3" number="17.3.1">
<h3>
<span class="header-section-number">17.3.1</span> Transforming label<a class="anchor" aria-label="anchor" href="#transforming-label"><i class="fas fa-link"></i></a>
</h3>
<p>Machine learning does not accept string labels for categorical variables</p>
<ul>
<li>B -&gt; 0</li>
<li>M -&gt; 1</li>
</ul>
<div class="sourceCode" id="cb249"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb249-1"><a href="XGBoostalgorithm.html#cb249-1" tabindex="-1"></a><span class="co">#creating deepcopy of model instances</span></span>
<span id="cb249-2"><a href="XGBoostalgorithm.html#cb249-2" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> deepcopy</span>
<span id="cb249-3"><a href="XGBoostalgorithm.html#cb249-3" tabindex="-1"></a></span>
<span id="cb249-4"><a href="XGBoostalgorithm.html#cb249-4" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">'B'</span>, <span class="st">"M"</span>]</span>
<span id="cb249-5"><a href="XGBoostalgorithm.html#cb249-5" tabindex="-1"></a></span>
<span id="cb249-6"><a href="XGBoostalgorithm.html#cb249-6" tabindex="-1"></a>dat_copy <span class="op">=</span> deepcopy(dat)</span>
<span id="cb249-7"><a href="XGBoostalgorithm.html#cb249-7" tabindex="-1"></a>dat_copy[<span class="st">'diagnosis'</span>] <span class="op">=</span> dat_copy[<span class="st">'diagnosis'</span>].<span class="bu">map</span>({<span class="st">'B'</span>:<span class="dv">0</span>, <span class="st">'M'</span>:<span class="dv">1</span>})</span>
<span id="cb249-8"><a href="XGBoostalgorithm.html#cb249-8" tabindex="-1"></a>dat_copy.head(n<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb249-9"><a href="XGBoostalgorithm.html#cb249-9" tabindex="-1"></a><span class="co">#&gt;    diagnosis  radius_mean  ...  symmetry_worst  fractal_dimension_worst</span></span>
<span id="cb249-10"><a href="XGBoostalgorithm.html#cb249-10" tabindex="-1"></a><span class="co">#&gt; 0          1        17.99  ...          0.4601                  0.11890</span></span>
<span id="cb249-11"><a href="XGBoostalgorithm.html#cb249-11" tabindex="-1"></a><span class="co">#&gt; 1          1        20.57  ...          0.2750                  0.08902</span></span>
<span id="cb249-12"><a href="XGBoostalgorithm.html#cb249-12" tabindex="-1"></a><span class="co">#&gt; 2          1        19.69  ...          0.3613                  0.08758</span></span>
<span id="cb249-13"><a href="XGBoostalgorithm.html#cb249-13" tabindex="-1"></a><span class="co">#&gt; 3          1        11.42  ...          0.6638                  0.17300</span></span>
<span id="cb249-14"><a href="XGBoostalgorithm.html#cb249-14" tabindex="-1"></a><span class="co">#&gt; 4          1        20.29  ...          0.2364                  0.07678</span></span>
<span id="cb249-15"><a href="XGBoostalgorithm.html#cb249-15" tabindex="-1"></a><span class="co">#&gt; 5          1        12.45  ...          0.3985                  0.12440</span></span>
<span id="cb249-16"><a href="XGBoostalgorithm.html#cb249-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-17"><a href="XGBoostalgorithm.html#cb249-17" tabindex="-1"></a><span class="co">#&gt; [6 rows x 31 columns]</span></span></code></pre></div>
</div>
<div id="principal-component-analysis" class="section level3" number="17.3.2">
<h3>
<span class="header-section-number">17.3.2</span> Principal component analysis<a class="anchor" aria-label="anchor" href="#principal-component-analysis"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb250"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb250-1"><a href="XGBoostalgorithm.html#cb250-1" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb250-2"><a href="XGBoostalgorithm.html#cb250-2" tabindex="-1"></a><span class="co">#from sklearn.preprocessing import StandardScaler</span></span>
<span id="cb250-3"><a href="XGBoostalgorithm.html#cb250-3" tabindex="-1"></a></span>
<span id="cb250-4"><a href="XGBoostalgorithm.html#cb250-4" tabindex="-1"></a>data_remove <span class="op">=</span> dat_copy.drop([<span class="st">'diagnosis'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb250-5"><a href="XGBoostalgorithm.html#cb250-5" tabindex="-1"></a></span>
<span id="cb250-6"><a href="XGBoostalgorithm.html#cb250-6" tabindex="-1"></a><span class="co">#sc = StandardScaler()</span></span>
<span id="cb250-7"><a href="XGBoostalgorithm.html#cb250-7" tabindex="-1"></a><span class="co">#sc.fit_transform(data_remove)</span></span>
<span id="cb250-8"><a href="XGBoostalgorithm.html#cb250-8" tabindex="-1"></a></span>
<span id="cb250-9"><a href="XGBoostalgorithm.html#cb250-9" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb250-10"><a href="XGBoostalgorithm.html#cb250-10" tabindex="-1"></a>pca.fit(data_remove)</span></code></pre></div>
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style>
<div id="sk-container-id-1" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>PCA(n_components=2)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">PCA</label><div class="sk-toggleable__content"><pre>PCA(n_components=2)</pre></div>
</div></div></div>
</div>
<div class="sourceCode" id="cb251"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb251-1"><a href="XGBoostalgorithm.html#cb251-1" tabindex="-1"></a>data_remove_pca <span class="op">=</span> pca.transform(data_remove)</span>
<span id="cb251-2"><a href="XGBoostalgorithm.html#cb251-2" tabindex="-1"></a></span>
<span id="cb251-3"><a href="XGBoostalgorithm.html#cb251-3" tabindex="-1"></a>PCA_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb251-4"><a href="XGBoostalgorithm.html#cb251-4" tabindex="-1"></a>PCA_df[<span class="st">'PCA_1'</span>] <span class="op">=</span> data_remove_pca[:, <span class="dv">0</span>]</span>
<span id="cb251-5"><a href="XGBoostalgorithm.html#cb251-5" tabindex="-1"></a>PCA_df[<span class="st">'PCA_2'</span>] <span class="op">=</span> data_remove_pca[:, <span class="dv">1</span>]</span>
<span id="cb251-6"><a href="XGBoostalgorithm.html#cb251-6" tabindex="-1"></a>PCA_df[<span class="st">'diagnosis'</span>] <span class="op">=</span> dat[<span class="st">'diagnosis'</span>].tolist()</span>
<span id="cb251-7"><a href="XGBoostalgorithm.html#cb251-7" tabindex="-1"></a></span>
<span id="cb251-8"><a href="XGBoostalgorithm.html#cb251-8" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb251-9"><a href="XGBoostalgorithm.html#cb251-9" tabindex="-1"></a>sns.scatterplot(data <span class="op">=</span> PCA_df,</span>
<span id="cb251-10"><a href="XGBoostalgorithm.html#cb251-10" tabindex="-1"></a>                x <span class="op">=</span> <span class="st">'PCA_1'</span>, </span>
<span id="cb251-11"><a href="XGBoostalgorithm.html#cb251-11" tabindex="-1"></a>                y <span class="op">=</span> <span class="st">'PCA_2'</span>,</span>
<span id="cb251-12"><a href="XGBoostalgorithm.html#cb251-12" tabindex="-1"></a>                hue <span class="op">=</span> <span class="st">'diagnosis'</span>)</span>
<span id="cb251-13"><a href="XGBoostalgorithm.html#cb251-13" tabindex="-1"></a></span>
<span id="cb251-14"><a href="XGBoostalgorithm.html#cb251-14" tabindex="-1"></a>plt.title(<span class="st">"PCA"</span>)</span>
<span id="cb251-15"><a href="XGBoostalgorithm.html#cb251-15" tabindex="-1"></a>plt.xlabel(<span class="st">"First Principal Component"</span>)</span>
<span id="cb251-16"><a href="XGBoostalgorithm.html#cb251-16" tabindex="-1"></a>plt.ylabel(<span class="st">"Second Principal Component"</span>)</span>
<span id="cb251-17"><a href="XGBoostalgorithm.html#cb251-17" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'lower right'</span>, fontsize<span class="op">=</span><span class="st">"8"</span>)</span>
<span id="cb251-18"><a href="XGBoostalgorithm.html#cb251-18" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="71-MachineLearing_XGBoost_files/figure-html/unnamed-chunk-6-1.png" width="100%"></div>
</div>
<div id="data-partition-1" class="section level3" number="17.3.3">
<h3>
<span class="header-section-number">17.3.3</span> Data partition<a class="anchor" aria-label="anchor" href="#data-partition-1"><i class="fas fa-link"></i></a>
</h3>
<p>Creating train and test dataset under probability 0.7</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb252-1"><a href="XGBoostalgorithm.html#cb252-1" tabindex="-1"></a>X <span class="op">=</span> data_remove</span>
<span id="cb252-2"><a href="XGBoostalgorithm.html#cb252-2" tabindex="-1"></a>Y <span class="op">=</span> dat_copy.diagnosis</span>
<span id="cb252-3"><a href="XGBoostalgorithm.html#cb252-3" tabindex="-1"></a></span>
<span id="cb252-4"><a href="XGBoostalgorithm.html#cb252-4" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb252-5"><a href="XGBoostalgorithm.html#cb252-5" tabindex="-1"></a>    X,</span>
<span id="cb252-6"><a href="XGBoostalgorithm.html#cb252-6" tabindex="-1"></a>    Y,</span>
<span id="cb252-7"><a href="XGBoostalgorithm.html#cb252-7" tabindex="-1"></a>    test_size <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span id="cb252-8"><a href="XGBoostalgorithm.html#cb252-8" tabindex="-1"></a>    random_state <span class="op">=</span> <span class="dv">123</span>)</span>
<span id="cb252-9"><a href="XGBoostalgorithm.html#cb252-9" tabindex="-1"></a></span>
<span id="cb252-10"><a href="XGBoostalgorithm.html#cb252-10" tabindex="-1"></a><span class="co"># Cleaning test sets to avoid future warning messages</span></span>
<span id="cb252-11"><a href="XGBoostalgorithm.html#cb252-11" tabindex="-1"></a>y_train <span class="op">=</span> y_train.values.ravel() </span>
<span id="cb252-12"><a href="XGBoostalgorithm.html#cb252-12" tabindex="-1"></a>y_test <span class="op">=</span> y_test.values.ravel() </span>
<span id="cb252-13"><a href="XGBoostalgorithm.html#cb252-13" tabindex="-1"></a></span>
<span id="cb252-14"><a href="XGBoostalgorithm.html#cb252-14" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"training dataset:"</span>, x_train.shape[<span class="dv">0</span>], <span class="st">"sampels;"</span>, x_train.shape[<span class="dv">1</span>], <span class="st">"features"</span>)</span>
<span id="cb252-15"><a href="XGBoostalgorithm.html#cb252-15" tabindex="-1"></a><span class="co">#&gt; training dataset: 398 sampels; 30 features</span></span>
<span id="cb252-16"><a href="XGBoostalgorithm.html#cb252-16" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"test dataset:"</span>, x_test.shape[<span class="dv">0</span>], <span class="st">"sampels;"</span>, x_test.shape[<span class="dv">1</span>], <span class="st">"features"</span>)</span>
<span id="cb252-17"><a href="XGBoostalgorithm.html#cb252-17" tabindex="-1"></a><span class="co">#&gt; test dataset: 171 sampels; 30 features</span></span></code></pre></div>
</div>
<div id="feature-selection-1" class="section level3" number="17.3.4">
<h3>
<span class="header-section-number">17.3.4</span> Feature selection<a class="anchor" aria-label="anchor" href="#feature-selection-1"><i class="fas fa-link"></i></a>
</h3>
<p>We use the <strong>importance of random forest</strong> to select features by <code>selectFromModel</code>, selecting thoese features which importance is greater than the mean importance of all features by default. The following parameters:</p>
<ul>
<li>
<strong>estimator</strong>: The base estimator from which the transformer is built</li>
<li>
<strong>threshold</strong>: The threshold value to use for feature selection (mean default)</li>
</ul>
<div class="sourceCode" id="cb253"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb253-1"><a href="XGBoostalgorithm.html#cb253-1" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectFromModel</span>
<span id="cb253-2"><a href="XGBoostalgorithm.html#cb253-2" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb253-3"><a href="XGBoostalgorithm.html#cb253-3" tabindex="-1"></a></span>
<span id="cb253-4"><a href="XGBoostalgorithm.html#cb253-4" tabindex="-1"></a>sel <span class="op">=</span> SelectFromModel(estimator<span class="op">=</span>RandomForestClassifier(n_estimators <span class="op">=</span> <span class="dv">1000</span>),</span>
<span id="cb253-5"><a href="XGBoostalgorithm.html#cb253-5" tabindex="-1"></a>                      threshold<span class="op">=</span><span class="st">"mean"</span>)</span>
<span id="cb253-6"><a href="XGBoostalgorithm.html#cb253-6" tabindex="-1"></a>sel.fit(x_train, y_train)</span></code></pre></div>
<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style>
<div id="sk-container-id-2" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>SelectFromModel(estimator=RandomForestClassifier(n_estimators=1000),
                threshold='mean')</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped">
<div class="sk-label-container"><div class="sk-label sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">SelectFromModel</label><div class="sk-toggleable__content"><pre>SelectFromModel(estimator=RandomForestClassifier(n_estimators=1000),
                threshold='mean')</pre></div>
</div></div>
<div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item">
<div class="sk-label-container"><div class="sk-label sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier(n_estimators=1000)</pre></div>
</div></div>
<div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier(n_estimators=1000)</pre></div>
</div></div></div>
</div></div></div>
</div></div>
</div>
<div class="sourceCode" id="cb254"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb254-1"><a href="XGBoostalgorithm.html#cb254-1" tabindex="-1"></a></span>
<span id="cb254-2"><a href="XGBoostalgorithm.html#cb254-2" tabindex="-1"></a><span class="co"># estimator parameters</span></span>
<span id="cb254-3"><a href="XGBoostalgorithm.html#cb254-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"the parameters of estimator"</span>, sel.get_params())</span>
<span id="cb254-4"><a href="XGBoostalgorithm.html#cb254-4" tabindex="-1"></a><span class="co">#&gt; the parameters of estimator {'estimator__bootstrap': True, 'estimator__ccp_alpha': 0.0, 'estimator__class_weight': None, 'estimator__criterion': 'gini', 'estimator__max_depth': None, 'estimator__max_features': 'sqrt', 'estimator__max_leaf_nodes': None, 'estimator__max_samples': None, 'estimator__min_impurity_decrease': 0.0, 'estimator__min_samples_leaf': 1, 'estimator__min_samples_split': 2, 'estimator__min_weight_fraction_leaf': 0.0, 'estimator__n_estimators': 1000, 'estimator__n_jobs': None, 'estimator__oob_score': False, 'estimator__random_state': None, 'estimator__verbose': 0, 'estimator__warm_start': False, 'estimator': RandomForestClassifier(n_estimators=1000), 'importance_getter': 'auto', 'max_features': None, 'norm_order': 1, 'prefit': False, 'threshold': 'mean'}</span></span>
<span id="cb254-5"><a href="XGBoostalgorithm.html#cb254-5" tabindex="-1"></a></span>
<span id="cb254-6"><a href="XGBoostalgorithm.html#cb254-6" tabindex="-1"></a><span class="co"># selected features</span></span>
<span id="cb254-7"><a href="XGBoostalgorithm.html#cb254-7" tabindex="-1"></a>selected_features <span class="op">=</span> x_train.columns[(sel.get_support())]</span>
<span id="cb254-8"><a href="XGBoostalgorithm.html#cb254-8" tabindex="-1"></a>x_train_select <span class="op">=</span> x_train[selected_features]</span>
<span id="cb254-9"><a href="XGBoostalgorithm.html#cb254-9" tabindex="-1"></a></span>
<span id="cb254-10"><a href="XGBoostalgorithm.html#cb254-10" tabindex="-1"></a></span>
<span id="cb254-11"><a href="XGBoostalgorithm.html#cb254-11" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"training dataset:"</span>, x_train_select.shape[<span class="dv">0</span>], <span class="st">"sampels;"</span>, x_train_select.shape[<span class="dv">1</span>], <span class="st">"features"</span>)</span>
<span id="cb254-12"><a href="XGBoostalgorithm.html#cb254-12" tabindex="-1"></a><span class="co">#&gt; training dataset: 398 sampels; 10 features</span></span></code></pre></div>
<ul>
<li>Remained features</li>
</ul>
<div class="sourceCode" id="cb255"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb255-1"><a href="XGBoostalgorithm.html#cb255-1" tabindex="-1"></a>x_train_select <span class="op">=</span> x_train[selected_features]</span>
<span id="cb255-2"><a href="XGBoostalgorithm.html#cb255-2" tabindex="-1"></a>x_test_select <span class="op">=</span> x_test[selected_features]</span>
<span id="cb255-3"><a href="XGBoostalgorithm.html#cb255-3" tabindex="-1"></a></span>
<span id="cb255-4"><a href="XGBoostalgorithm.html#cb255-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"training dataset:"</span>, x_train_select.shape[<span class="dv">0</span>], <span class="st">"sampels;"</span>, x_train_select.shape[<span class="dv">1</span>], <span class="st">"features"</span>)</span>
<span id="cb255-5"><a href="XGBoostalgorithm.html#cb255-5" tabindex="-1"></a><span class="co">#&gt; training dataset: 398 sampels; 10 features</span></span>
<span id="cb255-6"><a href="XGBoostalgorithm.html#cb255-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"test dataset:"</span>, x_test_select.shape[<span class="dv">0</span>], <span class="st">"sampels;"</span>, x_test_select.shape[<span class="dv">1</span>], <span class="st">"features"</span>)</span>
<span id="cb255-7"><a href="XGBoostalgorithm.html#cb255-7" tabindex="-1"></a><span class="co">#&gt; test dataset: 171 sampels; 10 features</span></span></code></pre></div>
</div>
<div id="base-model" class="section level3" number="17.3.5">
<h3>
<span class="header-section-number">17.3.5</span> Base model<a class="anchor" aria-label="anchor" href="#base-model"><i class="fas fa-link"></i></a>
</h3>
<p>base model for feature importance and AUC, Confusion Matrix</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb256-1"><a href="XGBoostalgorithm.html#cb256-1" tabindex="-1"></a>base_fit <span class="op">=</span> xgb.XGBClassifier(</span>
<span id="cb256-2"><a href="XGBoostalgorithm.html#cb256-2" tabindex="-1"></a>    objective<span class="op">=</span><span class="st">'binary:logistic'</span>,</span>
<span id="cb256-3"><a href="XGBoostalgorithm.html#cb256-3" tabindex="-1"></a>    booster<span class="op">=</span><span class="st">'gbtree'</span>,</span>
<span id="cb256-4"><a href="XGBoostalgorithm.html#cb256-4" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">'auc'</span>,</span>
<span id="cb256-5"><a href="XGBoostalgorithm.html#cb256-5" tabindex="-1"></a>    tree_method<span class="op">=</span><span class="st">'hist'</span>,</span>
<span id="cb256-6"><a href="XGBoostalgorithm.html#cb256-6" tabindex="-1"></a>    grow_policy<span class="op">=</span><span class="st">'lossguide'</span>,</span>
<span id="cb256-7"><a href="XGBoostalgorithm.html#cb256-7" tabindex="-1"></a>    use_label_encoder<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb256-8"><a href="XGBoostalgorithm.html#cb256-8" tabindex="-1"></a></span>
<span id="cb256-9"><a href="XGBoostalgorithm.html#cb256-9" tabindex="-1"></a></span>
<span id="cb256-10"><a href="XGBoostalgorithm.html#cb256-10" tabindex="-1"></a>base_fit.fit(x_train_select, y_train)</span></code></pre></div>
<style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style>
<div id="sk-container-id-3" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric='auc', feature_types=None,
              gamma=None, gpu_id=None, grow_policy='lossguide',
              importance_type=None, interaction_constraints=None,
              learning_rate=None, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None, ...)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric='auc', feature_types=None,
              gamma=None, gpu_id=None, grow_policy='lossguide',
              importance_type=None, interaction_constraints=None,
              learning_rate=None, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None, ...)</pre></div>
</div></div></div>
</div>
<div class="sourceCode" id="cb257"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb257-1"><a href="XGBoostalgorithm.html#cb257-1" tabindex="-1"></a></span>
<span id="cb257-2"><a href="XGBoostalgorithm.html#cb257-2" tabindex="-1"></a>y_pred <span class="op">=</span> base_fit.predict(x_test_select)</span>
<span id="cb257-3"><a href="XGBoostalgorithm.html#cb257-3" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb257-4"><a href="XGBoostalgorithm.html#cb257-4" tabindex="-1"></a></span>
<span id="cb257-5"><a href="XGBoostalgorithm.html#cb257-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy of base XBGoost model: </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(accuracy))</span>
<span id="cb257-6"><a href="XGBoostalgorithm.html#cb257-6" tabindex="-1"></a><span class="co">#&gt; Accuracy of base XBGoost model: 0.96</span></span></code></pre></div>
</div>
<div id="k-cross-validataion-for-n_estimators" class="section level3" number="17.3.6">
<h3>
<span class="header-section-number">17.3.6</span> K cross validataion for n_estimators<a class="anchor" aria-label="anchor" href="#k-cross-validataion-for-n_estimators"><i class="fas fa-link"></i></a>
</h3>
<p>The relationship between loss and number of tree</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb258-1"><a href="XGBoostalgorithm.html#cb258-1" tabindex="-1"></a><span class="kw">def</span> estimate_num_trees(X, y):</span>
<span id="cb258-2"><a href="XGBoostalgorithm.html#cb258-2" tabindex="-1"></a>    num_trees <span class="op">=</span> <span class="bu">range</span>(<span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">10</span>)</span>
<span id="cb258-3"><a href="XGBoostalgorithm.html#cb258-3" tabindex="-1"></a>    cv_errors <span class="op">=</span> []</span>
<span id="cb258-4"><a href="XGBoostalgorithm.html#cb258-4" tabindex="-1"></a></span>
<span id="cb258-5"><a href="XGBoostalgorithm.html#cb258-5" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> num_trees:</span>
<span id="cb258-6"><a href="XGBoostalgorithm.html#cb258-6" tabindex="-1"></a>        xgb_classifier <span class="op">=</span> xgb.XGBClassifier(n_estimators<span class="op">=</span>n, objective<span class="op">=</span><span class="st">'binary:logistic'</span>, eval_metric<span class="op">=</span><span class="st">'logloss'</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb258-7"><a href="XGBoostalgorithm.html#cb258-7" tabindex="-1"></a>        cv_scores <span class="op">=</span> cross_val_score(xgb_classifier, X, y, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'neg_log_loss'</span>)</span>
<span id="cb258-8"><a href="XGBoostalgorithm.html#cb258-8" tabindex="-1"></a>        cv_errors.append(<span class="op">-</span>np.mean(cv_scores))</span>
<span id="cb258-9"><a href="XGBoostalgorithm.html#cb258-9" tabindex="-1"></a></span>
<span id="cb258-10"><a href="XGBoostalgorithm.html#cb258-10" tabindex="-1"></a>    <span class="cf">return</span> num_trees, cv_errors</span>
<span id="cb258-11"><a href="XGBoostalgorithm.html#cb258-11" tabindex="-1"></a></span>
<span id="cb258-12"><a href="XGBoostalgorithm.html#cb258-12" tabindex="-1"></a><span class="kw">def</span> plot_error_vs_trees(num_trees, cv_errors):</span>
<span id="cb258-13"><a href="XGBoostalgorithm.html#cb258-13" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb258-14"><a href="XGBoostalgorithm.html#cb258-14" tabindex="-1"></a>    plt.plot(num_trees, cv_errors, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb258-15"><a href="XGBoostalgorithm.html#cb258-15" tabindex="-1"></a>    plt.xlabel(<span class="st">'No. of estimators'</span>)</span>
<span id="cb258-16"><a href="XGBoostalgorithm.html#cb258-16" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb258-17"><a href="XGBoostalgorithm.html#cb258-17" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb258-18"><a href="XGBoostalgorithm.html#cb258-18" tabindex="-1"></a>    plt.show()</span>
<span id="cb258-19"><a href="XGBoostalgorithm.html#cb258-19" tabindex="-1"></a></span>
<span id="cb258-20"><a href="XGBoostalgorithm.html#cb258-20" tabindex="-1"></a>num_trees, cv_errors <span class="op">=</span> estimate_num_trees(x_train_select, y_train)</span>
<span id="cb258-21"><a href="XGBoostalgorithm.html#cb258-21" tabindex="-1"></a>plot_error_vs_trees(num_trees, cv_errors)</span></code></pre></div>
<div class="inline-figure"><img src="71-MachineLearing_XGBoost_files/figure-html/unnamed-chunk-11-3.png" width="100%"></div>
</div>
<div id="tuning-parameters" class="section level3" number="17.3.7">
<h3>
<span class="header-section-number">17.3.7</span> Tuning parameters<a class="anchor" aria-label="anchor" href="#tuning-parameters"><i class="fas fa-link"></i></a>
</h3>
<blockquote>
<p>Before executing grid search algorithms, a benchmark model has to be fitted. By calling the fit() method, default parameters are obtained and stored for later use. Since GridSearchCV take inputs in lists, single parameter values also have to be wrapped. By calling fit() on the GridSearchCV instance, the cross-validation is performed, results are extracted, scores are computed and stored in a dictionary.</p>
</blockquote>
<p>It takes much time to iterate over the whole parameter grid, so setting the verbosity to 1 help to monitor the process. However, wall time does not equal the printed fitting time, hence the loop cycle time is also tracked and printed.</p>
<ul>
<li>
<strong>learning_rate/eta</strong>: Step size shrinkage used in update to prevents overfitting. After each boosting step, we can directly get the weights of new features(typical values: 0.01-0.2).</li>
<li>
<strong>max_depth</strong>: Maximum depth of a tree. Increasing this value will make the model more complex and more likely to overfit (typical values: 1-10).</li>
<li><del><strong>n_estimators</strong>: The number of decision tree.</del></li>
<li>
<strong>colsample_bytree</strong>: fraction of the features that can be used to train each tree. A large value means almost all features can be used to build the decision tree (typical values: 0.5-0.9).</li>
<li>
<strong>min_child_weight</strong>: It defines the minimum sum of weights of all observations required in a child. The larger min_child_weight is, the more conservative the algorithm will be.</li>
<li>
<strong>gamma</strong>: Minimum loss reduction required to make a further partition on a leaf node of the tree (typical values: 0-0.5).</li>
<li>
<strong>alpha/reg_alpha</strong>: L1 regularization term on weights. Increasing this value will make model more conservative (typical values: 0-1).</li>
<li>
<strong>lambda/reg_lambda</strong>: L2 regularization term on weights. Increasing this value will make model more conservative (typical values: 0-1).</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb259-1"><a href="XGBoostalgorithm.html#cb259-1" tabindex="-1"></a><span class="co">#extracting default parameters from benchmark model</span></span>
<span id="cb259-2"><a href="XGBoostalgorithm.html#cb259-2" tabindex="-1"></a>default_params <span class="op">=</span> {}</span>
<span id="cb259-3"><a href="XGBoostalgorithm.html#cb259-3" tabindex="-1"></a>gparams <span class="op">=</span> base_fit.get_params()</span>
<span id="cb259-4"><a href="XGBoostalgorithm.html#cb259-4" tabindex="-1"></a></span>
<span id="cb259-5"><a href="XGBoostalgorithm.html#cb259-5" tabindex="-1"></a><span class="co">#default parameters have to be wrapped in lists - even single values - so GridSearchCV can take them as inputs</span></span>
<span id="cb259-6"><a href="XGBoostalgorithm.html#cb259-6" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> gparams.keys():</span>
<span id="cb259-7"><a href="XGBoostalgorithm.html#cb259-7" tabindex="-1"></a>    gp <span class="op">=</span> gparams[key]</span>
<span id="cb259-8"><a href="XGBoostalgorithm.html#cb259-8" tabindex="-1"></a>    default_params[key] <span class="op">=</span> [gp]</span>
<span id="cb259-9"><a href="XGBoostalgorithm.html#cb259-9" tabindex="-1"></a></span>
<span id="cb259-10"><a href="XGBoostalgorithm.html#cb259-10" tabindex="-1"></a><span class="co">#benchmark model. Grid search is not performed, since only single values are provided as parameter grid.</span></span>
<span id="cb259-11"><a href="XGBoostalgorithm.html#cb259-11" tabindex="-1"></a><span class="co">#However, cross-validation is still executed</span></span>
<span id="cb259-12"><a href="XGBoostalgorithm.html#cb259-12" tabindex="-1"></a>clf0 <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>base_fit, </span>
<span id="cb259-13"><a href="XGBoostalgorithm.html#cb259-13" tabindex="-1"></a>                    scoring<span class="op">=</span><span class="st">'accuracy'</span>, </span>
<span id="cb259-14"><a href="XGBoostalgorithm.html#cb259-14" tabindex="-1"></a>                    param_grid<span class="op">=</span>default_params, </span>
<span id="cb259-15"><a href="XGBoostalgorithm.html#cb259-15" tabindex="-1"></a>                    return_train_score<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb259-16"><a href="XGBoostalgorithm.html#cb259-16" tabindex="-1"></a>                    verbose<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb259-17"><a href="XGBoostalgorithm.html#cb259-17" tabindex="-1"></a>                    cv<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb259-18"><a href="XGBoostalgorithm.html#cb259-18" tabindex="-1"></a>clf0.fit(x_train_select, y_train)</span></code></pre></div>
<style>#sk-container-id-4 {color: black;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style>
<div id="sk-container-id-4" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>GridSearchCV(cv=3,
             estimator=XGBClassifier(base_score=None, booster='gbtree',
                                     callbacks=None, colsample_bylevel=None,
                                     colsample_bynode=None,
                                     colsample_bytree=None,
                                     early_stopping_rounds=None,
                                     enable_categorical=False,
                                     eval_metric='auc', feature_types=None,
                                     gamma=None, gpu_id=None,
                                     grow_policy='lossguide',
                                     importance_type=None,
                                     interaction_constraints=None,
                                     learnin...
                         'max_cat_threshold': [None],
                         'max_cat_to_onehot': [None], 'max_delta_step': [None],
                         'max_depth': [None], 'max_leaves': [None],
                         'min_child_weight': [None], 'missing': [nan],
                         'monotone_constraints': [None], 'n_estimators': [100],
                         'n_jobs': [None], 'num_parallel_tree': [None],
                         'objective': ['binary:logistic'], 'predictor': [None], ...},
             return_train_score=True, scoring='accuracy', verbose=1)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped">
<div class="sk-label-container"><div class="sk-label sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=3,
             estimator=XGBClassifier(base_score=None, booster='gbtree',
                                     callbacks=None, colsample_bylevel=None,
                                     colsample_bynode=None,
                                     colsample_bytree=None,
                                     early_stopping_rounds=None,
                                     enable_categorical=False,
                                     eval_metric='auc', feature_types=None,
                                     gamma=None, gpu_id=None,
                                     grow_policy='lossguide',
                                     importance_type=None,
                                     interaction_constraints=None,
                                     learnin...
                         'max_cat_threshold': [None],
                         'max_cat_to_onehot': [None], 'max_delta_step': [None],
                         'max_depth': [None], 'max_leaves': [None],
                         'min_child_weight': [None], 'missing': [nan],
                         'monotone_constraints': [None], 'n_estimators': [100],
                         'n_jobs': [None], 'num_parallel_tree': [None],
                         'objective': ['binary:logistic'], 'predictor': [None], ...},
             return_train_score=True, scoring='accuracy', verbose=1)</pre></div>
</div></div>
<div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item">
<div class="sk-label-container"><div class="sk-label sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric='auc', feature_types=None,
              gamma=None, gpu_id=None, grow_policy='lossguide',
              importance_type=None, interaction_constraints=None,
              learning_rate=None, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None, ...)</pre></div>
</div></div>
<div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric='auc', feature_types=None,
              gamma=None, gpu_id=None, grow_policy='lossguide',
              importance_type=None, interaction_constraints=None,
              learning_rate=None, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None, ...)</pre></div>
</div></div></div>
</div></div></div>
</div></div>
</div>
<div class="sourceCode" id="cb260"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb260-1"><a href="XGBoostalgorithm.html#cb260-1" tabindex="-1"></a></span>
<span id="cb260-2"><a href="XGBoostalgorithm.html#cb260-2" tabindex="-1"></a><span class="co">#results dataframe</span></span>
<span id="cb260-3"><a href="XGBoostalgorithm.html#cb260-3" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(clf0.cv_results_)</span>
<span id="cb260-4"><a href="XGBoostalgorithm.html#cb260-4" tabindex="-1"></a></span>
<span id="cb260-5"><a href="XGBoostalgorithm.html#cb260-5" tabindex="-1"></a><span class="co">#predictions - inputs to confusion matrix</span></span>
<span id="cb260-6"><a href="XGBoostalgorithm.html#cb260-6" tabindex="-1"></a>test_predictions <span class="op">=</span> clf0.predict(x_test_select)</span>
<span id="cb260-7"><a href="XGBoostalgorithm.html#cb260-7" tabindex="-1"></a></span>
<span id="cb260-8"><a href="XGBoostalgorithm.html#cb260-8" tabindex="-1"></a><span class="co">#confusion matrices</span></span>
<span id="cb260-9"><a href="XGBoostalgorithm.html#cb260-9" tabindex="-1"></a>cfm_test <span class="op">=</span> confusion_matrix(y_test, test_predictions)</span>
<span id="cb260-10"><a href="XGBoostalgorithm.html#cb260-10" tabindex="-1"></a></span>
<span id="cb260-11"><a href="XGBoostalgorithm.html#cb260-11" tabindex="-1"></a><span class="co">#best parameters</span></span>
<span id="cb260-12"><a href="XGBoostalgorithm.html#cb260-12" tabindex="-1"></a>bp0 <span class="op">=</span> clf0.best_params_</span>
<span id="cb260-13"><a href="XGBoostalgorithm.html#cb260-13" tabindex="-1"></a></span>
<span id="cb260-14"><a href="XGBoostalgorithm.html#cb260-14" tabindex="-1"></a>df.head()</span>
<span id="cb260-15"><a href="XGBoostalgorithm.html#cb260-15" tabindex="-1"></a><span class="co">#&gt;    mean_fit_time  std_fit_time  ...  mean_train_score  std_train_score</span></span>
<span id="cb260-16"><a href="XGBoostalgorithm.html#cb260-16" tabindex="-1"></a><span class="co">#&gt; 0       0.042487      0.003309  ...          0.998742         0.001779</span></span>
<span id="cb260-17"><a href="XGBoostalgorithm.html#cb260-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb260-18"><a href="XGBoostalgorithm.html#cb260-18" tabindex="-1"></a><span class="co">#&gt; [1 rows x 56 columns]</span></span></code></pre></div>
<div class="sourceCode" id="cb261"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb261-1"><a href="XGBoostalgorithm.html#cb261-1" tabindex="-1"></a><span class="co"># tuning parameters</span></span>
<span id="cb261-2"><a href="XGBoostalgorithm.html#cb261-2" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb261-3"><a href="XGBoostalgorithm.html#cb261-3" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: [<span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="fl">0.06</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>],</span>
<span id="cb261-4"><a href="XGBoostalgorithm.html#cb261-4" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">1</span>)],</span>
<span id="cb261-5"><a href="XGBoostalgorithm.html#cb261-5" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>, <span class="dv">150</span>, <span class="dv">30</span>)],</span>
<span id="cb261-6"><a href="XGBoostalgorithm.html#cb261-6" tabindex="-1"></a>    <span class="st">'colsample_bytree'</span>: [np.<span class="bu">round</span>(x, <span class="dv">2</span>) <span class="cf">for</span> x <span class="kw">in</span> np.arange(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)],</span>
<span id="cb261-7"><a href="XGBoostalgorithm.html#cb261-7" tabindex="-1"></a>    <span class="st">'min_child_weight'</span>: [x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">1</span>)],    </span>
<span id="cb261-8"><a href="XGBoostalgorithm.html#cb261-8" tabindex="-1"></a>    <span class="st">'gamma'</span>: [<span class="dv">0</span>, <span class="fl">0.1</span> ,<span class="fl">0.2</span> ,<span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">3.2</span>, <span class="fl">6.4</span>, <span class="fl">12.8</span>, <span class="fl">25.6</span>, <span class="fl">51.2</span>, <span class="fl">102.4</span>, <span class="dv">200</span>],          </span>
<span id="cb261-9"><a href="XGBoostalgorithm.html#cb261-9" tabindex="-1"></a>    <span class="st">'reg_alpha'</span>: [<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">3.2</span>, <span class="fl">6.4</span>, <span class="fl">12.8</span>, <span class="fl">25.6</span>, <span class="fl">51.2</span>, <span class="fl">102.4</span>, <span class="dv">200</span>],</span>
<span id="cb261-10"><a href="XGBoostalgorithm.html#cb261-10" tabindex="-1"></a>    <span class="st">'reg_lambda'</span>: [<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">3.2</span>, <span class="fl">6.4</span>, <span class="fl">12.8</span>, <span class="fl">25.6</span>, <span class="fl">51.2</span>, <span class="fl">102.4</span>, <span class="dv">200</span>]</span>
<span id="cb261-11"><a href="XGBoostalgorithm.html#cb261-11" tabindex="-1"></a>    }</span>
<span id="cb261-12"><a href="XGBoostalgorithm.html#cb261-12" tabindex="-1"></a>    </span>
<span id="cb261-13"><a href="XGBoostalgorithm.html#cb261-13" tabindex="-1"></a>param_grid</span>
<span id="cb261-14"><a href="XGBoostalgorithm.html#cb261-14" tabindex="-1"></a><span class="co">#&gt; {'learning_rate': [0.01, 0.03, 0.06, 0.1, 0.15, 0.2, 0.25, 0.3, 0.4, 0.5, 0.6, 0.7], 'max_depth': [5, 6, 7, 8, 9, 10, 11, 12, 13, 14], 'n_estimators': [10, 40, 70, 100, 130], 'colsample_bytree': [0.5, 0.6, 0.7, 0.8, 0.9], 'min_child_weight': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 'gamma': [0, 0.1, 0.2, 0.4, 0.8, 1.6, 3.2, 6.4, 12.8, 25.6, 51.2, 102.4, 200], 'reg_alpha': [0, 0.1, 0.2, 0.4, 0.8, 1.6, 3.2, 6.4, 12.8, 25.6, 51.2, 102.4, 200], 'reg_lambda': [0, 0.1, 0.2, 0.4, 0.8, 1.6, 3.2, 6.4, 12.8, 25.6, 51.2, 102.4, 200]}</span></span></code></pre></div>
<ul>
<li>Grid search</li>
</ul>
<blockquote>
<p>“Grid search is a process that searches exhaustively through a manually specified subset of the hyperparameter space of the targeted algorithm…and evaluate(s) the cost function based on the generated hyperparameter sets”</p>
</blockquote>
<div class="sourceCode" id="cb262"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb262-1"><a href="XGBoostalgorithm.html#cb262-1" tabindex="-1"></a><span class="co">#creating deepcopy of default parameters before manipulations</span></span>
<span id="cb262-2"><a href="XGBoostalgorithm.html#cb262-2" tabindex="-1"></a>params <span class="op">=</span> deepcopy(default_params)</span>
<span id="cb262-3"><a href="XGBoostalgorithm.html#cb262-3" tabindex="-1"></a></span>
<span id="cb262-4"><a href="XGBoostalgorithm.html#cb262-4" tabindex="-1"></a><span class="co">#No. of jobs</span></span>
<span id="cb262-5"><a href="XGBoostalgorithm.html#cb262-5" tabindex="-1"></a>gcvj <span class="op">=</span> np.cumsum([<span class="bu">len</span>(x) <span class="cf">for</span> x <span class="kw">in</span> param_grid.values()])[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb262-6"><a href="XGBoostalgorithm.html#cb262-6" tabindex="-1"></a></span>
<span id="cb262-7"><a href="XGBoostalgorithm.html#cb262-7" tabindex="-1"></a><span class="co">#iteration loop. Each selected parameter iterated separately</span></span>
<span id="cb262-8"><a href="XGBoostalgorithm.html#cb262-8" tabindex="-1"></a><span class="cf">for</span> i, grid_key <span class="kw">in</span> <span class="bu">enumerate</span>(param_grid.keys()):</span>
<span id="cb262-9"><a href="XGBoostalgorithm.html#cb262-9" tabindex="-1"></a>    </span>
<span id="cb262-10"><a href="XGBoostalgorithm.html#cb262-10" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb262-11"><a href="XGBoostalgorithm.html#cb262-11" tabindex="-1"></a>    <span class="co">#variable for measuring iteration time</span></span>
<span id="cb262-12"><a href="XGBoostalgorithm.html#cb262-12" tabindex="-1"></a>    loop_start <span class="op">=</span> time.time()</span>
<span id="cb262-13"><a href="XGBoostalgorithm.html#cb262-13" tabindex="-1"></a>       </span>
<span id="cb262-14"><a href="XGBoostalgorithm.html#cb262-14" tabindex="-1"></a>    <span class="co">#creating param_grid argument for GridSearchCV:</span></span>
<span id="cb262-15"><a href="XGBoostalgorithm.html#cb262-15" tabindex="-1"></a>    <span class="co">#listing grid values of current iterable parameter and wrapping non-iterable parameter single values in list</span></span>
<span id="cb262-16"><a href="XGBoostalgorithm.html#cb262-16" tabindex="-1"></a>    <span class="cf">for</span> param_key <span class="kw">in</span> params.keys():</span>
<span id="cb262-17"><a href="XGBoostalgorithm.html#cb262-17" tabindex="-1"></a>        <span class="cf">if</span> param_key <span class="op">==</span> grid_key:</span>
<span id="cb262-18"><a href="XGBoostalgorithm.html#cb262-18" tabindex="-1"></a>            params[param_key] <span class="op">=</span> param_grid[grid_key]</span>
<span id="cb262-19"><a href="XGBoostalgorithm.html#cb262-19" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb262-20"><a href="XGBoostalgorithm.html#cb262-20" tabindex="-1"></a>            <span class="co"># use best parameters of last iteration</span></span>
<span id="cb262-21"><a href="XGBoostalgorithm.html#cb262-21" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb262-22"><a href="XGBoostalgorithm.html#cb262-22" tabindex="-1"></a>                param_value <span class="op">=</span> [clf.best_params_[param_key]]</span>
<span id="cb262-23"><a href="XGBoostalgorithm.html#cb262-23" tabindex="-1"></a>                params[param_key] <span class="op">=</span> param_value</span>
<span id="cb262-24"><a href="XGBoostalgorithm.html#cb262-24" tabindex="-1"></a>            <span class="co">#use benchmark model parameters for first iteration</span></span>
<span id="cb262-25"><a href="XGBoostalgorithm.html#cb262-25" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb262-26"><a href="XGBoostalgorithm.html#cb262-26" tabindex="-1"></a>                param_value <span class="op">=</span> [clf0.best_params_[param_key]]</span>
<span id="cb262-27"><a href="XGBoostalgorithm.html#cb262-27" tabindex="-1"></a>                params[param_key] <span class="op">=</span> param_value</span>
<span id="cb262-28"><a href="XGBoostalgorithm.html#cb262-28" tabindex="-1"></a>    </span>
<span id="cb262-29"><a href="XGBoostalgorithm.html#cb262-29" tabindex="-1"></a>    <span class="co">#classifier instance of current iteration</span></span>
<span id="cb262-30"><a href="XGBoostalgorithm.html#cb262-30" tabindex="-1"></a>    xgbc <span class="op">=</span> xgb.XGBClassifier(<span class="op">**</span>default_params)</span>
<span id="cb262-31"><a href="XGBoostalgorithm.html#cb262-31" tabindex="-1"></a>    </span>
<span id="cb262-32"><a href="XGBoostalgorithm.html#cb262-32" tabindex="-1"></a>    <span class="co">#GridSearch instance of current iteration</span></span>
<span id="cb262-33"><a href="XGBoostalgorithm.html#cb262-33" tabindex="-1"></a>    clf <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>xgbc, </span>
<span id="cb262-34"><a href="XGBoostalgorithm.html#cb262-34" tabindex="-1"></a>                    param_grid<span class="op">=</span>params,</span>
<span id="cb262-35"><a href="XGBoostalgorithm.html#cb262-35" tabindex="-1"></a>                    scoring<span class="op">=</span><span class="st">'accuracy'</span>, </span>
<span id="cb262-36"><a href="XGBoostalgorithm.html#cb262-36" tabindex="-1"></a>                    return_train_score<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb262-37"><a href="XGBoostalgorithm.html#cb262-37" tabindex="-1"></a>                    verbose<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb262-38"><a href="XGBoostalgorithm.html#cb262-38" tabindex="-1"></a>                    cv<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb262-39"><a href="XGBoostalgorithm.html#cb262-39" tabindex="-1"></a>    clf.fit(x_train_select, y_train)</span>
<span id="cb262-40"><a href="XGBoostalgorithm.html#cb262-40" tabindex="-1"></a></span>
<span id="cb262-41"><a href="XGBoostalgorithm.html#cb262-41" tabindex="-1"></a>    <span class="co">#predictions - inputs to confusion matrix</span></span>
<span id="cb262-42"><a href="XGBoostalgorithm.html#cb262-42" tabindex="-1"></a>    train_predictions <span class="op">=</span> clf.predict(x_train_select)</span>
<span id="cb262-43"><a href="XGBoostalgorithm.html#cb262-43" tabindex="-1"></a>    test_predictions <span class="op">=</span> clf.predict(x_test_select)</span>
<span id="cb262-44"><a href="XGBoostalgorithm.html#cb262-44" tabindex="-1"></a>        </span>
<span id="cb262-45"><a href="XGBoostalgorithm.html#cb262-45" tabindex="-1"></a>    <span class="co">#confusion matrices</span></span>
<span id="cb262-46"><a href="XGBoostalgorithm.html#cb262-46" tabindex="-1"></a>    cfm_train <span class="op">=</span> confusion_matrix(y_train, train_predictions)</span>
<span id="cb262-47"><a href="XGBoostalgorithm.html#cb262-47" tabindex="-1"></a>    cfm_test <span class="op">=</span> confusion_matrix(y_test, test_predictions)</span>
<span id="cb262-48"><a href="XGBoostalgorithm.html#cb262-48" tabindex="-1"></a>    <span class="bu">print</span>(cfm_train)</span>
<span id="cb262-49"><a href="XGBoostalgorithm.html#cb262-49" tabindex="-1"></a>    <span class="bu">print</span>(cfm_test)</span>
<span id="cb262-50"><a href="XGBoostalgorithm.html#cb262-50" tabindex="-1"></a>    </span>
<span id="cb262-51"><a href="XGBoostalgorithm.html#cb262-51" tabindex="-1"></a>    <span class="co">#best parameters</span></span>
<span id="cb262-52"><a href="XGBoostalgorithm.html#cb262-52" tabindex="-1"></a>    bp_gs <span class="op">=</span> clf.best_params_</span></code></pre></div>
<style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style>
<div id="sk-container-id-5" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>GridSearchCV(cv=3,
             estimator=XGBClassifier(base_score=[None], booster=['gbtree'],
                                     callbacks=[None], colsample_bylevel=[None],
                                     colsample_bynode=[None],
                                     colsample_bytree=[None],
                                     early_stopping_rounds=[None],
                                     enable_categorical=[False],
                                     eval_metric=['auc'], feature_types=[None],
                                     gamma=[None], gpu_id=[None],
                                     grow_policy=['lossguide'],
                                     importance_type=[None],
                                     interact...
                         'max_cat_threshold': [None],
                         'max_cat_to_onehot': [None], 'max_delta_step': [None],
                         'max_depth': [5], 'max_leaves': [None],
                         'min_child_weight': [1], 'missing': [nan],
                         'monotone_constraints': [None], 'n_estimators': [70],
                         'n_jobs': [None], 'num_parallel_tree': [None],
                         'objective': ['binary:logistic'], 'predictor': [None], ...},
             return_train_score=True, scoring='accuracy', verbose=1)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped">
<div class="sk-label-container"><div class="sk-label sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox"><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=3,
             estimator=XGBClassifier(base_score=[None], booster=['gbtree'],
                                     callbacks=[None], colsample_bylevel=[None],
                                     colsample_bynode=[None],
                                     colsample_bytree=[None],
                                     early_stopping_rounds=[None],
                                     enable_categorical=[False],
                                     eval_metric=['auc'], feature_types=[None],
                                     gamma=[None], gpu_id=[None],
                                     grow_policy=['lossguide'],
                                     importance_type=[None],
                                     interact...
                         'max_cat_threshold': [None],
                         'max_cat_to_onehot': [None], 'max_delta_step': [None],
                         'max_depth': [5], 'max_leaves': [None],
                         'min_child_weight': [1], 'missing': [nan],
                         'monotone_constraints': [None], 'n_estimators': [70],
                         'n_jobs': [None], 'num_parallel_tree': [None],
                         'objective': ['binary:logistic'], 'predictor': [None], ...},
             return_train_score=True, scoring='accuracy', verbose=1)</pre></div>
</div></div>
<div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item">
<div class="sk-label-container"><div class="sk-label sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox"><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=[None], booster=['gbtree'], callbacks=[None],
              colsample_bylevel=[None], colsample_bynode=[None],
              colsample_bytree=[None], early_stopping_rounds=[None],
              enable_categorical=[False], eval_metric=['auc'],
              feature_types=[None], gamma=[None], gpu_id=[None],
              grow_policy=['lossguide'], importance_type=[None],
              interaction_constraints=[None], learning_rate=[None],
              max_bin=[None], max_cat_threshold=[None],
              max_cat_to_onehot=[None], max_delta_step=[None], max_depth=[None],
              max_leaves=[None], min_child_weight=[None], missing=[nan],
              monotone_constraints=[None], n_estimators=[100], n_jobs=[None],
              num_parallel_tree=[None], objective=['binary:logistic'],
              predictor=[None], ...)</pre></div>
</div></div>
<div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox"><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=[None], booster=['gbtree'], callbacks=[None],
              colsample_bylevel=[None], colsample_bynode=[None],
              colsample_bytree=[None], early_stopping_rounds=[None],
              enable_categorical=[False], eval_metric=['auc'],
              feature_types=[None], gamma=[None], gpu_id=[None],
              grow_policy=['lossguide'], importance_type=[None],
              interaction_constraints=[None], learning_rate=[None],
              max_bin=[None], max_cat_threshold=[None],
              max_cat_to_onehot=[None], max_delta_step=[None], max_depth=[None],
              max_leaves=[None], min_child_weight=[None], missing=[nan],
              monotone_constraints=[None], n_estimators=[100], n_jobs=[None],
              num_parallel_tree=[None], objective=['binary:logistic'],
              predictor=[None], ...)</pre></div>
</div></div></div>
</div></div></div>
</div></div>
</div>
<div class="sourceCode" id="cb263"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb263-1"><a href="XGBoostalgorithm.html#cb263-1" tabindex="-1"></a>bp_gs</span>
<span id="cb263-2"><a href="XGBoostalgorithm.html#cb263-2" tabindex="-1"></a><span class="co">#&gt; {'base_score': None, 'booster': 'gbtree', 'callbacks': None, 'colsample_bylevel': None, 'colsample_bynode': None, 'colsample_bytree': 0.7, 'early_stopping_rounds': None, 'enable_categorical': False, 'eval_metric': 'auc', 'feature_types': None, 'gamma': 0, 'gpu_id': None, 'grow_policy': 'lossguide', 'importance_type': None, 'interaction_constraints': None, 'learning_rate': 0.01, 'max_bin': None, 'max_cat_threshold': None, 'max_cat_to_onehot': None, 'max_delta_step': None, 'max_depth': 5, 'max_leaves': None, 'min_child_weight': 1, 'missing': nan, 'monotone_constraints': None, 'n_estimators': 70, 'n_jobs': None, 'num_parallel_tree': None, 'objective': 'binary:logistic', 'predictor': None, 'random_state': None, 'reg_alpha': 0, 'reg_lambda': 0.1, 'sampling_method': None, 'scale_pos_weight': None, 'subsample': None, 'tree_method': 'hist', 'use_label_encoder': False, 'validate_parameters': None, 'verbosity': None}</span></span></code></pre></div>
<ul>
<li>Randomized search</li>
</ul>
<blockquote>
<p>“Random search…selects a value for each hyperparameter independently using a probability distribution…and evaluate(s) the cost function based on the generated hyperparameter sets”</p>
</blockquote>
<div class="sourceCode" id="cb264"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb264-1"><a href="XGBoostalgorithm.html#cb264-1" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb264-2"><a href="XGBoostalgorithm.html#cb264-2" tabindex="-1"></a><span class="co">#No. of jobs</span></span>
<span id="cb264-3"><a href="XGBoostalgorithm.html#cb264-3" tabindex="-1"></a><span class="co">rcvj = gcvj</span></span>
<span id="cb264-4"><a href="XGBoostalgorithm.html#cb264-4" tabindex="-1"></a></span>
<span id="cb264-5"><a href="XGBoostalgorithm.html#cb264-5" tabindex="-1"></a><span class="co">#unwrapping list values of default parameters</span></span>
<span id="cb264-6"><a href="XGBoostalgorithm.html#cb264-6" tabindex="-1"></a><span class="co">default_params_xgb = {}</span></span>
<span id="cb264-7"><a href="XGBoostalgorithm.html#cb264-7" tabindex="-1"></a></span>
<span id="cb264-8"><a href="XGBoostalgorithm.html#cb264-8" tabindex="-1"></a><span class="co">for key in default_params.keys():</span></span>
<span id="cb264-9"><a href="XGBoostalgorithm.html#cb264-9" tabindex="-1"></a><span class="co">    default_params_xgb[key] = default_params[key][0]</span></span>
<span id="cb264-10"><a href="XGBoostalgorithm.html#cb264-10" tabindex="-1"></a></span>
<span id="cb264-11"><a href="XGBoostalgorithm.html#cb264-11" tabindex="-1"></a><span class="co">#providing default parameters to xgbc model, before randomized search cross-validation</span></span>
<span id="cb264-12"><a href="XGBoostalgorithm.html#cb264-12" tabindex="-1"></a><span class="co">xgbc = xgb.XGBClassifier(**default_params_xgb)</span></span>
<span id="cb264-13"><a href="XGBoostalgorithm.html#cb264-13" tabindex="-1"></a></span>
<span id="cb264-14"><a href="XGBoostalgorithm.html#cb264-14" tabindex="-1"></a><span class="co">#Executing Randomized Search</span></span>
<span id="cb264-15"><a href="XGBoostalgorithm.html#cb264-15" tabindex="-1"></a><span class="co">clf1 = RandomizedSearchCV(</span></span>
<span id="cb264-16"><a href="XGBoostalgorithm.html#cb264-16" tabindex="-1"></a><span class="co">    estimator=xgbc,</span></span>
<span id="cb264-17"><a href="XGBoostalgorithm.html#cb264-17" tabindex="-1"></a><span class="co">    param_distributions=param_grid, </span></span>
<span id="cb264-18"><a href="XGBoostalgorithm.html#cb264-18" tabindex="-1"></a><span class="co">    scoring='accuracy',</span></span>
<span id="cb264-19"><a href="XGBoostalgorithm.html#cb264-19" tabindex="-1"></a><span class="co">    return_train_score=True, </span></span>
<span id="cb264-20"><a href="XGBoostalgorithm.html#cb264-20" tabindex="-1"></a><span class="co">    verbose=1, </span></span>
<span id="cb264-21"><a href="XGBoostalgorithm.html#cb264-21" tabindex="-1"></a><span class="co">    cv=3, </span></span>
<span id="cb264-22"><a href="XGBoostalgorithm.html#cb264-22" tabindex="-1"></a><span class="co">    n_iter=rcvj)</span></span>
<span id="cb264-23"><a href="XGBoostalgorithm.html#cb264-23" tabindex="-1"></a><span class="co">clf1.fit(x_train_select, y_train)</span></span>
<span id="cb264-24"><a href="XGBoostalgorithm.html#cb264-24" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb264-25"><a href="XGBoostalgorithm.html#cb264-25" tabindex="-1"></a><span class="co">#results dataframe</span></span>
<span id="cb264-26"><a href="XGBoostalgorithm.html#cb264-26" tabindex="-1"></a><span class="co">df1 = pd.DataFrame(clf1.cv_results_)</span></span>
<span id="cb264-27"><a href="XGBoostalgorithm.html#cb264-27" tabindex="-1"></a></span>
<span id="cb264-28"><a href="XGBoostalgorithm.html#cb264-28" tabindex="-1"></a><span class="co">#predictions - inputs to confusion matrix</span></span>
<span id="cb264-29"><a href="XGBoostalgorithm.html#cb264-29" tabindex="-1"></a><span class="co">train_predictions = clf1.predict(x_train_select)</span></span>
<span id="cb264-30"><a href="XGBoostalgorithm.html#cb264-30" tabindex="-1"></a><span class="co">test_predictions = clf1.predict(x_test_select)</span></span>
<span id="cb264-31"><a href="XGBoostalgorithm.html#cb264-31" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb264-32"><a href="XGBoostalgorithm.html#cb264-32" tabindex="-1"></a><span class="co">#confusion matrices</span></span>
<span id="cb264-33"><a href="XGBoostalgorithm.html#cb264-33" tabindex="-1"></a><span class="co">cfm_train = confusion_matrix(y_train, train_predictions)</span></span>
<span id="cb264-34"><a href="XGBoostalgorithm.html#cb264-34" tabindex="-1"></a><span class="co">cfm_test = confusion_matrix(y_test, test_predictions)</span></span>
<span id="cb264-35"><a href="XGBoostalgorithm.html#cb264-35" tabindex="-1"></a><span class="co">print(cfm_train)</span></span>
<span id="cb264-36"><a href="XGBoostalgorithm.html#cb264-36" tabindex="-1"></a><span class="co">print(cfm_test)</span></span>
<span id="cb264-37"><a href="XGBoostalgorithm.html#cb264-37" tabindex="-1"></a></span>
<span id="cb264-38"><a href="XGBoostalgorithm.html#cb264-38" tabindex="-1"></a><span class="co">#accuracy scores</span></span>
<span id="cb264-39"><a href="XGBoostalgorithm.html#cb264-39" tabindex="-1"></a><span class="co">accs_train = accuracy_score(y_train, train_predictions)</span></span>
<span id="cb264-40"><a href="XGBoostalgorithm.html#cb264-40" tabindex="-1"></a><span class="co">accs_test = accuracy_score(y_test, test_predictions)</span></span>
<span id="cb264-41"><a href="XGBoostalgorithm.html#cb264-41" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb264-42"><a href="XGBoostalgorithm.html#cb264-42" tabindex="-1"></a><span class="co">#F1 scores for each train/test label</span></span>
<span id="cb264-43"><a href="XGBoostalgorithm.html#cb264-43" tabindex="-1"></a><span class="co">f1s_train_p1 = f1_score(y_train, train_predictions, pos_label=1)</span></span>
<span id="cb264-44"><a href="XGBoostalgorithm.html#cb264-44" tabindex="-1"></a><span class="co">f1s_train_p0 = f1_score(y_train, train_predictions, pos_label=0)</span></span>
<span id="cb264-45"><a href="XGBoostalgorithm.html#cb264-45" tabindex="-1"></a><span class="co">f1s_test_p1 = f1_score(y_test, test_predictions, pos_label=1)</span></span>
<span id="cb264-46"><a href="XGBoostalgorithm.html#cb264-46" tabindex="-1"></a><span class="co">f1s_test_p0 = f1_score(y_test, test_predictions, pos_label=0)</span></span>
<span id="cb264-47"><a href="XGBoostalgorithm.html#cb264-47" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb264-48"><a href="XGBoostalgorithm.html#cb264-48" tabindex="-1"></a><span class="co">#Area Under the Receiver Operating Characteristic Curve</span></span>
<span id="cb264-49"><a href="XGBoostalgorithm.html#cb264-49" tabindex="-1"></a><span class="co">test_ras = roc_auc_score(y_test, clf1.predict_proba(x_test_select)[:,1])</span></span>
<span id="cb264-50"><a href="XGBoostalgorithm.html#cb264-50" tabindex="-1"></a></span>
<span id="cb264-51"><a href="XGBoostalgorithm.html#cb264-51" tabindex="-1"></a><span class="co">#best parameters</span></span>
<span id="cb264-52"><a href="XGBoostalgorithm.html#cb264-52" tabindex="-1"></a><span class="co">bp_rs = clf1.best_params_</span></span>
<span id="cb264-53"><a href="XGBoostalgorithm.html#cb264-53" tabindex="-1"></a></span>
<span id="cb264-54"><a href="XGBoostalgorithm.html#cb264-54" tabindex="-1"></a><span class="co">bp_rs</span></span>
<span id="cb264-55"><a href="XGBoostalgorithm.html#cb264-55" tabindex="-1"></a></span>
<span id="cb264-56"><a href="XGBoostalgorithm.html#cb264-56" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb264-57"><a href="XGBoostalgorithm.html#cb264-57" tabindex="-1"></a><span class="co">#&gt; "\n#No. of jobs\nrcvj = gcvj\n\n#unwrapping list values of default parameters\ndefault_params_xgb = {}\n\nfor key in default_params.keys():\n    default_params_xgb[key] = default_params[key][0]\n\n#providing default parameters to xgbc model, before randomized search cross-validation\nxgbc = xgb.XGBClassifier(**default_params_xgb)\n\n#Executing Randomized Search\nclf1 = RandomizedSearchCV(\n    estimator=xgbc,\n    param_distributions=param_grid, \n    scoring='accuracy',\n    return_train_score=True, \n    verbose=1, \n    cv=3, \n    n_iter=rcvj)\nclf1.fit(x_train_select, y_train)\n    \n#results dataframe\ndf1 = pd.DataFrame(clf1.cv_results_)\n\n#predictions - inputs to confusion matrix\ntrain_predictions = clf1.predict(x_train_select)\ntest_predictions = clf1.predict(x_test_select)\n    \n#confusion matrices\ncfm_train = confusion_matrix(y_train, train_predictions)\ncfm_test = confusion_matrix(y_test, test_predictions)\nprint(cfm_train)\nprint(cfm_test)\n\n#accuracy scores\naccs_train = accuracy_score(y_train, train_predictions)\naccs_test = accuracy_score(y_test, test_predictions)\n    \n#F1 scores for each train/test label\nf1s_train_p1 = f1_score(y_train, train_predictions, pos_label=1)\nf1s_train_p0 = f1_score(y_train, train_predictions, pos_label=0)\nf1s_test_p1 = f1_score(y_test, test_predictions, pos_label=1)\nf1s_test_p0 = f1_score(y_test, test_predictions, pos_label=0)\n    \n#Area Under the Receiver Operating Characteristic Curve\ntest_ras = roc_auc_score(y_test, clf1.predict_proba(x_test_select)[:,1])\n\n#best parameters\nbp_rs = clf1.best_params_\n\nbp_rs\n\n"</span></span></code></pre></div>
<ul>
<li>Bayesian search</li>
</ul>
<blockquote>
<p>“…build a probability model of the objective function and use it to select the most promising hyperparameters to evaluate in the true objective function”</p>
</blockquote>
<div class="sourceCode" id="cb265"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb265-1"><a href="XGBoostalgorithm.html#cb265-1" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb265-2"><a href="XGBoostalgorithm.html#cb265-2" tabindex="-1"></a></span>
<span id="cb265-3"><a href="XGBoostalgorithm.html#cb265-3" tabindex="-1"></a><span class="co">#No. of jobs</span></span>
<span id="cb265-4"><a href="XGBoostalgorithm.html#cb265-4" tabindex="-1"></a><span class="co">bcvj = int(gcvj)</span></span>
<span id="cb265-5"><a href="XGBoostalgorithm.html#cb265-5" tabindex="-1"></a></span>
<span id="cb265-6"><a href="XGBoostalgorithm.html#cb265-6" tabindex="-1"></a><span class="co">#unwrapping list values of default parameters</span></span>
<span id="cb265-7"><a href="XGBoostalgorithm.html#cb265-7" tabindex="-1"></a><span class="co">default_params_xgb = {}</span></span>
<span id="cb265-8"><a href="XGBoostalgorithm.html#cb265-8" tabindex="-1"></a></span>
<span id="cb265-9"><a href="XGBoostalgorithm.html#cb265-9" tabindex="-1"></a><span class="co">for key in default_params.keys():</span></span>
<span id="cb265-10"><a href="XGBoostalgorithm.html#cb265-10" tabindex="-1"></a><span class="co">    default_params_xgb[key] = default_params[key][0]</span></span>
<span id="cb265-11"><a href="XGBoostalgorithm.html#cb265-11" tabindex="-1"></a></span>
<span id="cb265-12"><a href="XGBoostalgorithm.html#cb265-12" tabindex="-1"></a><span class="co">#providing default parameters to xgbc model, before randomized search cross-validation</span></span>
<span id="cb265-13"><a href="XGBoostalgorithm.html#cb265-13" tabindex="-1"></a><span class="co">xgbc = xgb.XGBClassifier(**default_params_xgb)</span></span>
<span id="cb265-14"><a href="XGBoostalgorithm.html#cb265-14" tabindex="-1"></a></span>
<span id="cb265-15"><a href="XGBoostalgorithm.html#cb265-15" tabindex="-1"></a><span class="co">clf2 = BayesSearchCV(</span></span>
<span id="cb265-16"><a href="XGBoostalgorithm.html#cb265-16" tabindex="-1"></a><span class="co">    estimator=xgbc, </span></span>
<span id="cb265-17"><a href="XGBoostalgorithm.html#cb265-17" tabindex="-1"></a><span class="co">    search_spaces=param_grid, </span></span>
<span id="cb265-18"><a href="XGBoostalgorithm.html#cb265-18" tabindex="-1"></a><span class="co">    n_iter=bcvj, </span></span>
<span id="cb265-19"><a href="XGBoostalgorithm.html#cb265-19" tabindex="-1"></a><span class="co">    scoring='accuracy', </span></span>
<span id="cb265-20"><a href="XGBoostalgorithm.html#cb265-20" tabindex="-1"></a><span class="co">    cv=3, </span></span>
<span id="cb265-21"><a href="XGBoostalgorithm.html#cb265-21" tabindex="-1"></a><span class="co">    return_train_score=True, </span></span>
<span id="cb265-22"><a href="XGBoostalgorithm.html#cb265-22" tabindex="-1"></a><span class="co">    verbose=3)</span></span>
<span id="cb265-23"><a href="XGBoostalgorithm.html#cb265-23" tabindex="-1"></a><span class="co">clf2.fit(x_train_select, y_train)</span></span>
<span id="cb265-24"><a href="XGBoostalgorithm.html#cb265-24" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb265-25"><a href="XGBoostalgorithm.html#cb265-25" tabindex="-1"></a><span class="co">#results dataframe</span></span>
<span id="cb265-26"><a href="XGBoostalgorithm.html#cb265-26" tabindex="-1"></a><span class="co">df2 = pd.DataFrame(clf2.cv_results_)</span></span>
<span id="cb265-27"><a href="XGBoostalgorithm.html#cb265-27" tabindex="-1"></a></span>
<span id="cb265-28"><a href="XGBoostalgorithm.html#cb265-28" tabindex="-1"></a><span class="co">#predictions - inputs to confusion matrix</span></span>
<span id="cb265-29"><a href="XGBoostalgorithm.html#cb265-29" tabindex="-1"></a><span class="co">train_predictions = clf2.predict(x_train_select)</span></span>
<span id="cb265-30"><a href="XGBoostalgorithm.html#cb265-30" tabindex="-1"></a><span class="co">test_predictions = clf2.predict(x_test_select)</span></span>
<span id="cb265-31"><a href="XGBoostalgorithm.html#cb265-31" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb265-32"><a href="XGBoostalgorithm.html#cb265-32" tabindex="-1"></a><span class="co">#confusion matrices</span></span>
<span id="cb265-33"><a href="XGBoostalgorithm.html#cb265-33" tabindex="-1"></a><span class="co">cfm_train = confusion_matrix(y_train, train_predictions)</span></span>
<span id="cb265-34"><a href="XGBoostalgorithm.html#cb265-34" tabindex="-1"></a><span class="co">cfm_test = confusion_matrix(y_test, test_predictions)</span></span>
<span id="cb265-35"><a href="XGBoostalgorithm.html#cb265-35" tabindex="-1"></a><span class="co">print(cfm_train)</span></span>
<span id="cb265-36"><a href="XGBoostalgorithm.html#cb265-36" tabindex="-1"></a><span class="co">print(cfm_test)</span></span>
<span id="cb265-37"><a href="XGBoostalgorithm.html#cb265-37" tabindex="-1"></a></span>
<span id="cb265-38"><a href="XGBoostalgorithm.html#cb265-38" tabindex="-1"></a></span>
<span id="cb265-39"><a href="XGBoostalgorithm.html#cb265-39" tabindex="-1"></a><span class="co">#accuracy scores</span></span>
<span id="cb265-40"><a href="XGBoostalgorithm.html#cb265-40" tabindex="-1"></a><span class="co">accs_train = accuracy_score(y_train, train_predictions)</span></span>
<span id="cb265-41"><a href="XGBoostalgorithm.html#cb265-41" tabindex="-1"></a><span class="co">accs_test = accuracy_score(y_test, test_predictions)</span></span>
<span id="cb265-42"><a href="XGBoostalgorithm.html#cb265-42" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb265-43"><a href="XGBoostalgorithm.html#cb265-43" tabindex="-1"></a><span class="co">#F1 scores for each train/test label</span></span>
<span id="cb265-44"><a href="XGBoostalgorithm.html#cb265-44" tabindex="-1"></a><span class="co">f1s_train_p1 = f1_score(y_train, train_predictions, pos_label=1)</span></span>
<span id="cb265-45"><a href="XGBoostalgorithm.html#cb265-45" tabindex="-1"></a><span class="co">f1s_train_p0 = f1_score(y_train, train_predictions, pos_label=0)</span></span>
<span id="cb265-46"><a href="XGBoostalgorithm.html#cb265-46" tabindex="-1"></a><span class="co">f1s_test_p1 = f1_score(y_test, test_predictions, pos_label=1)</span></span>
<span id="cb265-47"><a href="XGBoostalgorithm.html#cb265-47" tabindex="-1"></a><span class="co">f1s_test_p0 = f1_score(y_test, test_predictions, pos_label=0)</span></span>
<span id="cb265-48"><a href="XGBoostalgorithm.html#cb265-48" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb265-49"><a href="XGBoostalgorithm.html#cb265-49" tabindex="-1"></a><span class="co">#Area Under the Receiver Operating Characteristic Curve</span></span>
<span id="cb265-50"><a href="XGBoostalgorithm.html#cb265-50" tabindex="-1"></a><span class="co">test_ras = roc_auc_score(y_test, clf2.predict_proba(x_test_select)[:,1])</span></span>
<span id="cb265-51"><a href="XGBoostalgorithm.html#cb265-51" tabindex="-1"></a></span>
<span id="cb265-52"><a href="XGBoostalgorithm.html#cb265-52" tabindex="-1"></a></span>
<span id="cb265-53"><a href="XGBoostalgorithm.html#cb265-53" tabindex="-1"></a><span class="co">#best parameters</span></span>
<span id="cb265-54"><a href="XGBoostalgorithm.html#cb265-54" tabindex="-1"></a><span class="co">bp_bs = clf2.best_params_</span></span>
<span id="cb265-55"><a href="XGBoostalgorithm.html#cb265-55" tabindex="-1"></a></span>
<span id="cb265-56"><a href="XGBoostalgorithm.html#cb265-56" tabindex="-1"></a><span class="co">bp_bs</span></span>
<span id="cb265-57"><a href="XGBoostalgorithm.html#cb265-57" tabindex="-1"></a></span>
<span id="cb265-58"><a href="XGBoostalgorithm.html#cb265-58" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb265-59"><a href="XGBoostalgorithm.html#cb265-59" tabindex="-1"></a><span class="co">#&gt; "\n\n#No. of jobs\nbcvj = int(gcvj)\n\n#unwrapping list values of default parameters\ndefault_params_xgb = {}\n\nfor key in default_params.keys():\n    default_params_xgb[key] = default_params[key][0]\n\n#providing default parameters to xgbc model, before randomized search cross-validation\nxgbc = xgb.XGBClassifier(**default_params_xgb)\n\nclf2 = BayesSearchCV(\n    estimator=xgbc, \n    search_spaces=param_grid, \n    n_iter=bcvj, \n    scoring='accuracy', \n    cv=3, \n    return_train_score=True, \n    verbose=3)\nclf2.fit(x_train_select, y_train)\n    \n#results dataframe\ndf2 = pd.DataFrame(clf2.cv_results_)\n\n#predictions - inputs to confusion matrix\ntrain_predictions = clf2.predict(x_train_select)\ntest_predictions = clf2.predict(x_test_select)\n    \n#confusion matrices\ncfm_train = confusion_matrix(y_train, train_predictions)\ncfm_test = confusion_matrix(y_test, test_predictions)\nprint(cfm_train)\nprint(cfm_test)\n\n\n#accuracy scores\naccs_train = accuracy_score(y_train, train_predictions)\naccs_test = accuracy_score(y_test, test_predictions)\n    \n#F1 scores for each train/test label\nf1s_train_p1 = f1_score(y_train, train_predictions, pos_label=1)\nf1s_train_p0 = f1_score(y_train, train_predictions, pos_label=0)\nf1s_test_p1 = f1_score(y_test, test_predictions, pos_label=1)\nf1s_test_p0 = f1_score(y_test, test_predictions, pos_label=0)\n    \n#Area Under the Receiver Operating Characteristic Curve\ntest_ras = roc_auc_score(y_test, clf2.predict_proba(x_test_select)[:,1])\n\n\n#best parameters\nbp_bs = clf2.best_params_\n\nbp_bs\n\n"</span></span></code></pre></div>
</div>
<div id="build-final-classifier" class="section level3" number="17.3.8">
<h3>
<span class="header-section-number">17.3.8</span> Build final classifier<a class="anchor" aria-label="anchor" href="#build-final-classifier"><i class="fas fa-link"></i></a>
</h3>
<p>The optimal parameters to build classifier</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb266-1"><a href="XGBoostalgorithm.html#cb266-1" tabindex="-1"></a>final_params <span class="op">=</span> bp_gs</span>
<span id="cb266-2"><a href="XGBoostalgorithm.html#cb266-2" tabindex="-1"></a><span class="co">#final_params = bp_rs</span></span>
<span id="cb266-3"><a href="XGBoostalgorithm.html#cb266-3" tabindex="-1"></a><span class="co">#final_params = bp_bs</span></span>
<span id="cb266-4"><a href="XGBoostalgorithm.html#cb266-4" tabindex="-1"></a></span>
<span id="cb266-5"><a href="XGBoostalgorithm.html#cb266-5" tabindex="-1"></a>xgb_final <span class="op">=</span> xgb.XGBClassifier(<span class="op">**</span>final_params)</span>
<span id="cb266-6"><a href="XGBoostalgorithm.html#cb266-6" tabindex="-1"></a></span>
<span id="cb266-7"><a href="XGBoostalgorithm.html#cb266-7" tabindex="-1"></a>xgb_final.fit(x_train_select, y_train)</span></code></pre></div>
<style>#sk-container-id-6 {color: black;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style>
<div id="sk-container-id-6" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.7, early_stopping_rounds=None,
              enable_categorical=False, eval_metric='auc', feature_types=None,
              gamma=0, gpu_id=None, grow_policy='lossguide',
              importance_type=None, interaction_constraints=None,
              learning_rate=0.01, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=5,
              max_leaves=None, min_child_weight=1, missing=nan,
              monotone_constraints=None, n_estimators=70, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None, ...)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" checked><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.7, early_stopping_rounds=None,
              enable_categorical=False, eval_metric='auc', feature_types=None,
              gamma=0, gpu_id=None, grow_policy='lossguide',
              importance_type=None, interaction_constraints=None,
              learning_rate=0.01, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=5,
              max_leaves=None, min_child_weight=1, missing=nan,
              monotone_constraints=None, n_estimators=70, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None, ...)</pre></div>
</div></div></div>
</div>
<div class="sourceCode" id="cb267"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb267-1"><a href="XGBoostalgorithm.html#cb267-1" tabindex="-1"></a></span>
<span id="cb267-2"><a href="XGBoostalgorithm.html#cb267-2" tabindex="-1"></a>classifier_score <span class="op">=</span> xgb_final.score(x_train_select, y_train)</span>
<span id="cb267-3"><a href="XGBoostalgorithm.html#cb267-3" tabindex="-1"></a></span>
<span id="cb267-4"><a href="XGBoostalgorithm.html#cb267-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">The classifier accuracy score is </span><span class="sc">{:03.2f}</span><span class="ch">\n</span><span class="st">'</span>.<span class="bu">format</span>(classifier_score))</span>
<span id="cb267-5"><a href="XGBoostalgorithm.html#cb267-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb267-6"><a href="XGBoostalgorithm.html#cb267-6" tabindex="-1"></a><span class="co">#&gt; The classifier accuracy score is 0.98</span></span></code></pre></div>
</div>
<div id="evaluating-model-performance" class="section level3" number="17.3.9">
<h3>
<span class="header-section-number">17.3.9</span> Evaluating model performance<a class="anchor" aria-label="anchor" href="#evaluating-model-performance"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>confusion matrix to display the performance</li>
</ul>
<div class="sourceCode" id="cb268"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb268-1"><a href="XGBoostalgorithm.html#cb268-1" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb268-2"><a href="XGBoostalgorithm.html#cb268-2" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image, display</span>
<span id="cb268-3"><a href="XGBoostalgorithm.html#cb268-3" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics, preprocessing</span>
<span id="cb268-4"><a href="XGBoostalgorithm.html#cb268-4" tabindex="-1"></a></span>
<span id="cb268-5"><a href="XGBoostalgorithm.html#cb268-5" tabindex="-1"></a>predicted <span class="op">=</span> xgb_final.predict(x_test_select)</span>
<span id="cb268-6"><a href="XGBoostalgorithm.html#cb268-6" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, predicted)</span>
<span id="cb268-7"><a href="XGBoostalgorithm.html#cb268-7" tabindex="-1"></a></span>
<span id="cb268-8"><a href="XGBoostalgorithm.html#cb268-8" tabindex="-1"></a>cm <span class="op">=</span> metrics.confusion_matrix(y_test, predicted)</span>
<span id="cb268-9"><a href="XGBoostalgorithm.html#cb268-9" tabindex="-1"></a></span>
<span id="cb268-10"><a href="XGBoostalgorithm.html#cb268-10" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb268-11"><a href="XGBoostalgorithm.html#cb268-11" tabindex="-1"></a>ax.matshow(cm, cmap<span class="op">=</span>plt.cm.Reds, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb268-12"><a href="XGBoostalgorithm.html#cb268-12" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(cm.shape[<span class="dv">0</span>]):</span>
<span id="cb268-13"><a href="XGBoostalgorithm.html#cb268-13" tabindex="-1"></a>     <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cm.shape[<span class="dv">1</span>]):</span>
<span id="cb268-14"><a href="XGBoostalgorithm.html#cb268-14" tabindex="-1"></a>         ax.text(x<span class="op">=</span>j, y<span class="op">=</span>i,</span>
<span id="cb268-15"><a href="XGBoostalgorithm.html#cb268-15" tabindex="-1"></a>                s<span class="op">=</span>cm[i, j], </span>
<span id="cb268-16"><a href="XGBoostalgorithm.html#cb268-16" tabindex="-1"></a>                va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb268-17"><a href="XGBoostalgorithm.html#cb268-17" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted Values'</span>, )</span>
<span id="cb268-18"><a href="XGBoostalgorithm.html#cb268-18" tabindex="-1"></a>plt.ylabel(<span class="st">'Actual Values'</span>)</span>
<span id="cb268-19"><a href="XGBoostalgorithm.html#cb268-19" tabindex="-1"></a></span>
<span id="cb268-20"><a href="XGBoostalgorithm.html#cb268-20" tabindex="-1"></a>ax.set_xticklabels([<span class="st">''</span>] <span class="op">+</span> group_names)</span>
<span id="cb268-21"><a href="XGBoostalgorithm.html#cb268-21" tabindex="-1"></a>ax.set_yticklabels([<span class="st">''</span>] <span class="op">+</span> group_names)</span>
<span id="cb268-22"><a href="XGBoostalgorithm.html#cb268-22" tabindex="-1"></a></span>
<span id="cb268-23"><a href="XGBoostalgorithm.html#cb268-23" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="71-MachineLearing_XGBoost_files/figure-html/unnamed-chunk-18-5.png" width="100%"></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb269-1"><a href="XGBoostalgorithm.html#cb269-1" tabindex="-1"></a>y_pred <span class="op">=</span> xgb_final.predict(x_test_select)</span>
<span id="cb269-2"><a href="XGBoostalgorithm.html#cb269-2" tabindex="-1"></a></span>
<span id="cb269-3"><a href="XGBoostalgorithm.html#cb269-3" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb269-4"><a href="XGBoostalgorithm.html#cb269-4" tabindex="-1"></a>conf_matrix <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb269-5"><a href="XGBoostalgorithm.html#cb269-5" tabindex="-1"></a>classification_rep <span class="op">=</span> classification_report(y_test, y_pred)</span>
<span id="cb269-6"><a href="XGBoostalgorithm.html#cb269-6" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb269-7"><a href="XGBoostalgorithm.html#cb269-7" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb269-8"><a href="XGBoostalgorithm.html#cb269-8" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb269-9"><a href="XGBoostalgorithm.html#cb269-9" tabindex="-1"></a></span>
<span id="cb269-10"><a href="XGBoostalgorithm.html#cb269-10" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> conf_matrix.ravel()</span>
<span id="cb269-11"><a href="XGBoostalgorithm.html#cb269-11" tabindex="-1"></a>specificity <span class="op">=</span> tn <span class="op">/</span> (tn <span class="op">+</span> fp)</span>
<span id="cb269-12"><a href="XGBoostalgorithm.html#cb269-12" tabindex="-1"></a>sensitivity <span class="op">=</span> tn <span class="op">/</span> (tn <span class="op">+</span> fn)</span>
<span id="cb269-13"><a href="XGBoostalgorithm.html#cb269-13" tabindex="-1"></a>false_positive_rate <span class="op">=</span> fp <span class="op">/</span> (fp <span class="op">+</span> tn)</span>
<span id="cb269-14"><a href="XGBoostalgorithm.html#cb269-14" tabindex="-1"></a></span>
<span id="cb269-15"><a href="XGBoostalgorithm.html#cb269-15" tabindex="-1"></a>index_df <span class="op">=</span> pd.DataFrame([[<span class="st">'Accuracy'</span>, accuracy], </span>
<span id="cb269-16"><a href="XGBoostalgorithm.html#cb269-16" tabindex="-1"></a>                         [<span class="st">'Specificity'</span>, specificity],</span>
<span id="cb269-17"><a href="XGBoostalgorithm.html#cb269-17" tabindex="-1"></a>                         [<span class="st">'Sensitivity'</span>, sensitivity],</span>
<span id="cb269-18"><a href="XGBoostalgorithm.html#cb269-18" tabindex="-1"></a>                         [<span class="st">'Precision'</span>, precision], </span>
<span id="cb269-19"><a href="XGBoostalgorithm.html#cb269-19" tabindex="-1"></a>                         [<span class="st">'Recall'</span>, recall],</span>
<span id="cb269-20"><a href="XGBoostalgorithm.html#cb269-20" tabindex="-1"></a>                         [<span class="st">'F1 score'</span>, f1],</span>
<span id="cb269-21"><a href="XGBoostalgorithm.html#cb269-21" tabindex="-1"></a>                         [<span class="st">'False Positive Rate'</span>, false_positive_rate]], </span>
<span id="cb269-22"><a href="XGBoostalgorithm.html#cb269-22" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Index'</span>, <span class="st">'Value'</span>])</span>
<span id="cb269-23"><a href="XGBoostalgorithm.html#cb269-23" tabindex="-1"></a></span>
<span id="cb269-24"><a href="XGBoostalgorithm.html#cb269-24" tabindex="-1"></a>index_df</span>
<span id="cb269-25"><a href="XGBoostalgorithm.html#cb269-25" tabindex="-1"></a><span class="co">#&gt;                  Index     Value</span></span>
<span id="cb269-26"><a href="XGBoostalgorithm.html#cb269-26" tabindex="-1"></a><span class="co">#&gt; 0             Accuracy  0.947368</span></span>
<span id="cb269-27"><a href="XGBoostalgorithm.html#cb269-27" tabindex="-1"></a><span class="co">#&gt; 1          Specificity  0.970874</span></span>
<span id="cb269-28"><a href="XGBoostalgorithm.html#cb269-28" tabindex="-1"></a><span class="co">#&gt; 2          Sensitivity  0.943396</span></span>
<span id="cb269-29"><a href="XGBoostalgorithm.html#cb269-29" tabindex="-1"></a><span class="co">#&gt; 3            Precision  0.953846</span></span>
<span id="cb269-30"><a href="XGBoostalgorithm.html#cb269-30" tabindex="-1"></a><span class="co">#&gt; 4               Recall  0.911765</span></span>
<span id="cb269-31"><a href="XGBoostalgorithm.html#cb269-31" tabindex="-1"></a><span class="co">#&gt; 5             F1 score  0.932331</span></span>
<span id="cb269-32"><a href="XGBoostalgorithm.html#cb269-32" tabindex="-1"></a><span class="co">#&gt; 6  False Positive Rate  0.029126</span></span></code></pre></div>
<ul>
<li>ROC Metrics</li>
</ul>
<p>ROC shows the AUC of sensitivity and specificity</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb270-1"><a href="XGBoostalgorithm.html#cb270-1" tabindex="-1"></a>predictions_prob <span class="op">=</span> xgb_final.predict_proba(x_test_select)[:, <span class="dv">1</span>]</span>
<span id="cb270-2"><a href="XGBoostalgorithm.html#cb270-2" tabindex="-1"></a></span>
<span id="cb270-3"><a href="XGBoostalgorithm.html#cb270-3" tabindex="-1"></a>fpr2, tpr2, _ <span class="op">=</span> roc_curve(y_test,</span>
<span id="cb270-4"><a href="XGBoostalgorithm.html#cb270-4" tabindex="-1"></a>                          predictions_prob,</span>
<span id="cb270-5"><a href="XGBoostalgorithm.html#cb270-5" tabindex="-1"></a>                          pos_label <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb270-6"><a href="XGBoostalgorithm.html#cb270-6" tabindex="-1"></a></span>
<span id="cb270-7"><a href="XGBoostalgorithm.html#cb270-7" tabindex="-1"></a>auc_rf <span class="op">=</span> auc(fpr2, tpr2)</span>
<span id="cb270-8"><a href="XGBoostalgorithm.html#cb270-8" tabindex="-1"></a></span>
<span id="cb270-9"><a href="XGBoostalgorithm.html#cb270-9" tabindex="-1"></a><span class="kw">def</span> plot_roc_curve(fpr, tpr, auc, estimator, xlim<span class="op">=</span><span class="va">None</span>, ylim<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb270-10"><a href="XGBoostalgorithm.html#cb270-10" tabindex="-1"></a></span>
<span id="cb270-11"><a href="XGBoostalgorithm.html#cb270-11" tabindex="-1"></a>    my_estimators <span class="op">=</span> {</span>
<span id="cb270-12"><a href="XGBoostalgorithm.html#cb270-12" tabindex="-1"></a>        <span class="st">'knn'</span>: [<span class="st">'Kth Nearest Neighbor'</span>, <span class="st">'deeppink'</span>],</span>
<span id="cb270-13"><a href="XGBoostalgorithm.html#cb270-13" tabindex="-1"></a>        <span class="st">'rf'</span>: [<span class="st">'Random Forest'</span>, <span class="st">'red'</span>],</span>
<span id="cb270-14"><a href="XGBoostalgorithm.html#cb270-14" tabindex="-1"></a>        <span class="st">'XGBoost'</span>: [<span class="st">'XGBoost'</span>, <span class="st">'purple'</span>]}</span>
<span id="cb270-15"><a href="XGBoostalgorithm.html#cb270-15" tabindex="-1"></a></span>
<span id="cb270-16"><a href="XGBoostalgorithm.html#cb270-16" tabindex="-1"></a>    plot_title <span class="op">=</span> my_estimators[estimator][<span class="dv">0</span>]</span>
<span id="cb270-17"><a href="XGBoostalgorithm.html#cb270-17" tabindex="-1"></a>    color_value <span class="op">=</span> my_estimators[estimator][<span class="dv">1</span>]</span>
<span id="cb270-18"><a href="XGBoostalgorithm.html#cb270-18" tabindex="-1"></a></span>
<span id="cb270-19"><a href="XGBoostalgorithm.html#cb270-19" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb270-20"><a href="XGBoostalgorithm.html#cb270-20" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#fafafa'</span>)</span>
<span id="cb270-21"><a href="XGBoostalgorithm.html#cb270-21" tabindex="-1"></a></span>
<span id="cb270-22"><a href="XGBoostalgorithm.html#cb270-22" tabindex="-1"></a>    plt.plot(fpr, tpr, color<span class="op">=</span>color_value, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb270-23"><a href="XGBoostalgorithm.html#cb270-23" tabindex="-1"></a>    plt.title(<span class="st">'ROC Curve For </span><span class="sc">{0}</span><span class="st"> (AUC = </span><span class="sc">{1: 0.3f}</span><span class="st">)'</span>.<span class="bu">format</span>(plot_title, auc))</span>
<span id="cb270-24"><a href="XGBoostalgorithm.html#cb270-24" tabindex="-1"></a></span>
<span id="cb270-25"><a href="XGBoostalgorithm.html#cb270-25" tabindex="-1"></a>    plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>) <span class="co"># Add Diagonal line</span></span>
<span id="cb270-26"><a href="XGBoostalgorithm.html#cb270-26" tabindex="-1"></a>    plt.plot([<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">0</span>], <span class="st">'k--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, color <span class="op">=</span> <span class="st">'grey'</span>)</span>
<span id="cb270-27"><a href="XGBoostalgorithm.html#cb270-27" tabindex="-1"></a>    plt.plot([<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">1</span>], <span class="st">'k--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, color <span class="op">=</span> <span class="st">'grey'</span>)</span>
<span id="cb270-28"><a href="XGBoostalgorithm.html#cb270-28" tabindex="-1"></a>    <span class="cf">if</span> xlim <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb270-29"><a href="XGBoostalgorithm.html#cb270-29" tabindex="-1"></a>        plt.xlim(<span class="op">*</span>xlim)</span>
<span id="cb270-30"><a href="XGBoostalgorithm.html#cb270-30" tabindex="-1"></a>    <span class="cf">if</span> ylim <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb270-31"><a href="XGBoostalgorithm.html#cb270-31" tabindex="-1"></a>        plt.ylim(<span class="op">*</span>ylim)</span>
<span id="cb270-32"><a href="XGBoostalgorithm.html#cb270-32" tabindex="-1"></a>    plt.xlabel(<span class="st">'False Positive Rate'</span>)</span>
<span id="cb270-33"><a href="XGBoostalgorithm.html#cb270-33" tabindex="-1"></a>    plt.ylabel(<span class="st">'True Positive Rate'</span>)</span>
<span id="cb270-34"><a href="XGBoostalgorithm.html#cb270-34" tabindex="-1"></a>    plt.show()</span>
<span id="cb270-35"><a href="XGBoostalgorithm.html#cb270-35" tabindex="-1"></a></span>
<span id="cb270-36"><a href="XGBoostalgorithm.html#cb270-36" tabindex="-1"></a>plot_roc_curve(fpr2, tpr2, auc_rf, <span class="st">'XGBoost'</span>,</span>
<span id="cb270-37"><a href="XGBoostalgorithm.html#cb270-37" tabindex="-1"></a>               xlim<span class="op">=</span>(<span class="op">-</span><span class="fl">0.01</span>, <span class="fl">1.05</span>), </span>
<span id="cb270-38"><a href="XGBoostalgorithm.html#cb270-38" tabindex="-1"></a>               ylim<span class="op">=</span>(<span class="fl">0.001</span>, <span class="fl">1.05</span>))</span></code></pre></div>
<div class="inline-figure"><img src="71-MachineLearing_XGBoost_files/figure-html/unnamed-chunk-20-7.png" width="100%"></div>
<ul>
<li>classification report</li>
</ul>
<div class="sourceCode" id="cb271"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb271-1"><a href="XGBoostalgorithm.html#cb271-1" tabindex="-1"></a><span class="kw">def</span> print_class_report(predictions, alg_name):</span>
<span id="cb271-2"><a href="XGBoostalgorithm.html#cb271-2" tabindex="-1"></a></span>
<span id="cb271-3"><a href="XGBoostalgorithm.html#cb271-3" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Classification Report for </span><span class="sc">{0}</span><span class="st">:'</span>.<span class="bu">format</span>(alg_name))</span>
<span id="cb271-4"><a href="XGBoostalgorithm.html#cb271-4" tabindex="-1"></a>    <span class="bu">print</span>(classification_report(predictions, </span>
<span id="cb271-5"><a href="XGBoostalgorithm.html#cb271-5" tabindex="-1"></a>            y_test, </span>
<span id="cb271-6"><a href="XGBoostalgorithm.html#cb271-6" tabindex="-1"></a>            target_names <span class="op">=</span> group_names))</span>
<span id="cb271-7"><a href="XGBoostalgorithm.html#cb271-7" tabindex="-1"></a></span>
<span id="cb271-8"><a href="XGBoostalgorithm.html#cb271-8" tabindex="-1"></a>class_report <span class="op">=</span> print_class_report(predicted, <span class="st">'XGBoost'</span>)</span>
<span id="cb271-9"><a href="XGBoostalgorithm.html#cb271-9" tabindex="-1"></a><span class="co">#&gt; Classification Report for XGBoost:</span></span>
<span id="cb271-10"><a href="XGBoostalgorithm.html#cb271-10" tabindex="-1"></a><span class="co">#&gt;               precision    recall  f1-score   support</span></span>
<span id="cb271-11"><a href="XGBoostalgorithm.html#cb271-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb271-12"><a href="XGBoostalgorithm.html#cb271-12" tabindex="-1"></a><span class="co">#&gt;            B       0.97      0.94      0.96       106</span></span>
<span id="cb271-13"><a href="XGBoostalgorithm.html#cb271-13" tabindex="-1"></a><span class="co">#&gt;            M       0.91      0.95      0.93        65</span></span>
<span id="cb271-14"><a href="XGBoostalgorithm.html#cb271-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb271-15"><a href="XGBoostalgorithm.html#cb271-15" tabindex="-1"></a><span class="co">#&gt;     accuracy                           0.95       171</span></span>
<span id="cb271-16"><a href="XGBoostalgorithm.html#cb271-16" tabindex="-1"></a><span class="co">#&gt;    macro avg       0.94      0.95      0.94       171</span></span>
<span id="cb271-17"><a href="XGBoostalgorithm.html#cb271-17" tabindex="-1"></a><span class="co">#&gt; weighted avg       0.95      0.95      0.95       171</span></span></code></pre></div>
</div>
<div id="feature-importance" class="section level3" number="17.3.10">
<h3>
<span class="header-section-number">17.3.10</span> Feature Importance<a class="anchor" aria-label="anchor" href="#feature-importance"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb272"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb272-1"><a href="XGBoostalgorithm.html#cb272-1" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb272-2"><a href="XGBoostalgorithm.html#cb272-2" tabindex="-1"></a><span class="co">#&gt; &lt;Figure size 1600x1200 with 0 Axes&gt;</span></span>
<span id="cb272-3"><a href="XGBoostalgorithm.html#cb272-3" tabindex="-1"></a></span>
<span id="cb272-4"><a href="XGBoostalgorithm.html#cb272-4" tabindex="-1"></a>xgb.plot_importance(xgb_final)</span>
<span id="cb272-5"><a href="XGBoostalgorithm.html#cb272-5" tabindex="-1"></a><span class="co">#&gt; &lt;Axes: title={'center': 'Feature importance'}, xlabel='F score', ylabel='Features'&gt;</span></span>
<span id="cb272-6"><a href="XGBoostalgorithm.html#cb272-6" tabindex="-1"></a></span>
<span id="cb272-7"><a href="XGBoostalgorithm.html#cb272-7" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="71-MachineLearing_XGBoost_files/figure-html/unnamed-chunk-22-9.png" width="100%"><img src="71-MachineLearing_XGBoost_files/figure-html/unnamed-chunk-22-10.png" width="100%"></p>
</div>
<div id="save-model" class="section level3" number="17.3.11">
<h3>
<span class="header-section-number">17.3.11</span> Save model<a class="anchor" aria-label="anchor" href="#save-model"><i class="fas fa-link"></i></a>
</h3>
<p>save a machine learning model using Python’s pickle module</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb273-1"><a href="XGBoostalgorithm.html#cb273-1" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb273-2"><a href="XGBoostalgorithm.html#cb273-2" tabindex="-1"></a></span>
<span id="cb273-3"><a href="XGBoostalgorithm.html#cb273-3" tabindex="-1"></a><span class="co">''' </span></span>
<span id="cb273-4"><a href="XGBoostalgorithm.html#cb273-4" tabindex="-1"></a><span class="co"># save classification model as a pickle file</span></span>
<span id="cb273-5"><a href="XGBoostalgorithm.html#cb273-5" tabindex="-1"></a><span class="co">model_pkl_file = "XGBoost.pkl"  </span></span>
<span id="cb273-6"><a href="XGBoostalgorithm.html#cb273-6" tabindex="-1"></a></span>
<span id="cb273-7"><a href="XGBoostalgorithm.html#cb273-7" tabindex="-1"></a><span class="co">with open(model_pkl_file, 'wb') as file:  </span></span>
<span id="cb273-8"><a href="XGBoostalgorithm.html#cb273-8" tabindex="-1"></a><span class="co">    pickle.dump(xgb_final, file)</span></span>
<span id="cb273-9"><a href="XGBoostalgorithm.html#cb273-9" tabindex="-1"></a></span>
<span id="cb273-10"><a href="XGBoostalgorithm.html#cb273-10" tabindex="-1"></a></span>
<span id="cb273-11"><a href="XGBoostalgorithm.html#cb273-11" tabindex="-1"></a><span class="co"># load model from pickle file</span></span>
<span id="cb273-12"><a href="XGBoostalgorithm.html#cb273-12" tabindex="-1"></a><span class="co">with open(model_pkl_file, 'rb') as file:  </span></span>
<span id="cb273-13"><a href="XGBoostalgorithm.html#cb273-13" tabindex="-1"></a><span class="co">    rfc_final = pickle.load(file)</span></span>
<span id="cb273-14"><a href="XGBoostalgorithm.html#cb273-14" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb273-15"><a href="XGBoostalgorithm.html#cb273-15" tabindex="-1"></a><span class="co">#&gt; ' \n# save classification model as a pickle file\nmodel_pkl_file = "XGBoost.pkl"  \n\nwith open(model_pkl_file, \'wb\') as file:  \n    pickle.dump(xgb_final, file)\n\n\n# load model from pickle file\nwith open(model_pkl_file, \'rb\') as file:  \n    rfc_final = pickle.load(file)\n'</span></span></code></pre></div>
</div>
</div>
<div id="session-info-8" class="section level2" number="17.4">
<h2>
<span class="header-section-number">17.4</span> Session info<a class="anchor" aria-label="anchor" href="#session-info-8"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb274"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb274-1"><a href="XGBoostalgorithm.html#cb274-1" tabindex="-1"></a><span class="im">import</span> session_info</span>
<span id="cb274-2"><a href="XGBoostalgorithm.html#cb274-2" tabindex="-1"></a></span>
<span id="cb274-3"><a href="XGBoostalgorithm.html#cb274-3" tabindex="-1"></a></span>
<span id="cb274-4"><a href="XGBoostalgorithm.html#cb274-4" tabindex="-1"></a>session_info.show()</span>
<span id="cb274-5"><a href="XGBoostalgorithm.html#cb274-5" tabindex="-1"></a><span class="co">#&gt; -----</span></span>
<span id="cb274-6"><a href="XGBoostalgorithm.html#cb274-6" tabindex="-1"></a><span class="co">#&gt; IPython             8.14.0</span></span>
<span id="cb274-7"><a href="XGBoostalgorithm.html#cb274-7" tabindex="-1"></a><span class="co">#&gt; matplotlib          3.7.2</span></span>
<span id="cb274-8"><a href="XGBoostalgorithm.html#cb274-8" tabindex="-1"></a><span class="co">#&gt; numpy               1.23.3</span></span>
<span id="cb274-9"><a href="XGBoostalgorithm.html#cb274-9" tabindex="-1"></a><span class="co">#&gt; pandas              2.0.3</span></span>
<span id="cb274-10"><a href="XGBoostalgorithm.html#cb274-10" tabindex="-1"></a><span class="co">#&gt; seaborn             0.12.2</span></span>
<span id="cb274-11"><a href="XGBoostalgorithm.html#cb274-11" tabindex="-1"></a><span class="co">#&gt; session_info        1.0.0</span></span>
<span id="cb274-12"><a href="XGBoostalgorithm.html#cb274-12" tabindex="-1"></a><span class="co">#&gt; sklearn             1.3.0</span></span>
<span id="cb274-13"><a href="XGBoostalgorithm.html#cb274-13" tabindex="-1"></a><span class="co">#&gt; skopt               0.9.0</span></span>
<span id="cb274-14"><a href="XGBoostalgorithm.html#cb274-14" tabindex="-1"></a><span class="co">#&gt; xgboost             1.7.6</span></span>
<span id="cb274-15"><a href="XGBoostalgorithm.html#cb274-15" tabindex="-1"></a><span class="co">#&gt; -----</span></span>
<span id="cb274-16"><a href="XGBoostalgorithm.html#cb274-16" tabindex="-1"></a><span class="co">#&gt; Python 3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:50:49) [Clang 14.0.6 ]</span></span>
<span id="cb274-17"><a href="XGBoostalgorithm.html#cb274-17" tabindex="-1"></a><span class="co">#&gt; macOS-12.2.1-x86_64-i386-64bit</span></span>
<span id="cb274-18"><a href="XGBoostalgorithm.html#cb274-18" tabindex="-1"></a><span class="co">#&gt; -----</span></span>
<span id="cb274-19"><a href="XGBoostalgorithm.html#cb274-19" tabindex="-1"></a><span class="co">#&gt; Session information updated at 2024-02-06 22:19</span></span></code></pre></div>
</div>
<div id="reference-14" class="section level2" number="17.5">
<h2>
<span class="header-section-number">17.5</span> Reference<a class="anchor" aria-label="anchor" href="#reference-14"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p><a href="https://towardsdatascience.com/binary-classification-xgboost-hyperparameter-tuning-scenarios-by-non-exhaustive-grid-search-and-c261f4ce098d">Binary Classification: XGBoost Hyperparameter Tuning Scenarios by Non-exhaustive Grid Search and Cross-Validation</a></p></li>
<li><p><a href="https://towardsdatascience.com/feature-selection-using-random-forest-26d7b747597f">Feature Selection Using Random forest</a></p></li>
</ul>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="randomforestalgorithm.html"><span class="header-section-number">16</span> Random Forest Algorithm</a></div>
<div class="next"><a href="Metageomics.html"><span class="header-section-number">18</span> Metageomics</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#XGBoostalgorithm"><span class="header-section-number">17</span> XGBoost Algorithm</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-preparation"><span class="header-section-number">17.0.1</span> Data Preparation</a></li>
<li><a class="nav-link" href="#data-description"><span class="header-section-number">17.0.2</span> Data Description</a></li>
<li><a class="nav-link" href="#data-preprocessing"><span class="header-section-number">17.0.3</span> Data Preprocessing</a></li>
<li><a class="nav-link" href="#data-partition"><span class="header-section-number">17.0.4</span> Data Partition</a></li>
<li><a class="nav-link" href="#feature-selection"><span class="header-section-number">17.0.5</span> Feature Selection</a></li>
<li><a class="nav-link" href="#model-training"><span class="header-section-number">17.0.6</span> Model training</a></li>
<li><a class="nav-link" href="#python-environment"><span class="header-section-number">17.0.7</span> python environment</a></li>
</ul>
</li>
<li><a class="nav-link" href="#loading-required-packages"><span class="header-section-number">17.1</span> Loading required packages</a></li>
<li><a class="nav-link" href="#data-preparation-1"><span class="header-section-number">17.2</span> Data Preparation</a></li>
<li>
<a class="nav-link" href="#xgboost-classification"><span class="header-section-number">17.3</span> XGBoost classification</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#transforming-label"><span class="header-section-number">17.3.1</span> Transforming label</a></li>
<li><a class="nav-link" href="#principal-component-analysis"><span class="header-section-number">17.3.2</span> Principal component analysis</a></li>
<li><a class="nav-link" href="#data-partition-1"><span class="header-section-number">17.3.3</span> Data partition</a></li>
<li><a class="nav-link" href="#feature-selection-1"><span class="header-section-number">17.3.4</span> Feature selection</a></li>
<li><a class="nav-link" href="#base-model"><span class="header-section-number">17.3.5</span> Base model</a></li>
<li><a class="nav-link" href="#k-cross-validataion-for-n_estimators"><span class="header-section-number">17.3.6</span> K cross validataion for n_estimators</a></li>
<li><a class="nav-link" href="#tuning-parameters"><span class="header-section-number">17.3.7</span> Tuning parameters</a></li>
<li><a class="nav-link" href="#build-final-classifier"><span class="header-section-number">17.3.8</span> Build final classifier</a></li>
<li><a class="nav-link" href="#evaluating-model-performance"><span class="header-section-number">17.3.9</span> Evaluating model performance</a></li>
<li><a class="nav-link" href="#feature-importance"><span class="header-section-number">17.3.10</span> Feature Importance</a></li>
<li><a class="nav-link" href="#save-model"><span class="header-section-number">17.3.11</span> Save model</a></li>
</ul>
</li>
<li><a class="nav-link" href="#session-info-8"><span class="header-section-number">17.4</span> Session info</a></li>
<li><a class="nav-link" href="#reference-14"><span class="header-section-number">17.5</span> Reference</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/HuaZou/DraftNotes/blob/main/71-MachineLearing_XGBoost.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/HuaZou/DraftNotes/edit/main/71-MachineLearing_XGBoost.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>生物信息随记</strong>" was written by Hua Zou. It was last built on 2023-08-24 and updated on 2024-02-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
