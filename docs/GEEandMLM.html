<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 GEE and MLM | 生物信息随记</title>
<meta name="author" content="Hua Zou">
<meta name="description" content="Tutorial of Generalized Estimating Equations and Mixed Linear Models 针对某个科学问题，通常会在一段时间内对多个同一研究对象进行多次或重复测量，这类数据一般称为纵向数据。纵向数据具有两个特点，一是研究对象重复；二是观察值可能存在缺失值。上述两个因素导致在探索结果和观测指标相关性分析时，一般线性（linear...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 3 GEE and MLM | 生物信息随记">
<meta property="og:type" content="book">
<meta property="og:url" content="https://zouhua.top/DraftNotes/GEEandMLM.html">
<meta property="og:description" content="Tutorial of Generalized Estimating Equations and Mixed Linear Models 针对某个科学问题，通常会在一段时间内对多个同一研究对象进行多次或重复测量，这类数据一般称为纵向数据。纵向数据具有两个特点，一是研究对象重复；二是观察值可能存在缺失值。上述两个因素导致在探索结果和观测指标相关性分析时，一般线性（linear...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 GEE and MLM | 生物信息随记">
<meta name="twitter:description" content="Tutorial of Generalized Estimating Equations and Mixed Linear Models 针对某个科学问题，通常会在一段时间内对多个同一研究对象进行多次或重复测量，这类数据一般称为纵向数据。纵向数据具有两个特点，一是研究对象重复；二是观察值可能存在缺失值。上述两个因素导致在探索结果和观测指标相关性分析时，一般线性（linear...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Poppins-0.4.6/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.6.0/transition.js"></script><script src="libs/bs3compat-0.6.0/tabs.js"></script><script src="libs/bs3compat-0.6.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.31/datatables.js"></script><link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="assets/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">生物信息随记</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> 介绍</a></li>
<li class="book-part">Data Set</li>
<li><a class="" href="ZeybelDataset.html"><span class="header-section-number">2</span> Zeybel Dataset</a></li>
<li class="book-part">Statistical Methods</li>
<li><a class="active" href="GEEandMLM.html"><span class="header-section-number">3</span> GEE and MLM</a></li>
<li><a class="" href="HypothesisTestingMethods.html"><span class="header-section-number">4</span> Hypothesis Testing Methods</a></li>
<li><a class="" href="BatchEffectCorrection.html"><span class="header-section-number">5</span> Batch Effect Correction</a></li>
<li><a class="" href="LinearModelonMicrobialCommunity.html"><span class="header-section-number">6</span> Linear Model on Microbial Community</a></li>
<li><a class="" href="PermutationTest.html"><span class="header-section-number">7</span> Permutation Test</a></li>
<li><a class="" href="SurvivalAnalysis.html"><span class="header-section-number">8</span> Survival Analysis</a></li>
<li class="book-part">Metabolomics Data Analysis</li>
<li><a class="" href="dataprocessing.html"><span class="header-section-number">9</span> Data Processing</a></li>
<li><a class="" href="DimensionReduction.html"><span class="header-section-number">10</span> Dimension Reduction</a></li>
<li><a class="" href="DifferetialAnalysis.html"><span class="header-section-number">11</span> Differetial Analysis</a></li>
<li><a class="" href="FunctionalAnalysis.html"><span class="header-section-number">12</span> Functional Analysis</a></li>
<li><a class="" href="MetOriginAnalysis.html"><span class="header-section-number">13</span> MetOrigin Analysis</a></li>
<li><a class="" href="OtherAnalysis.html"><span class="header-section-number">14</span> Other Analysis</a></li>
<li class="book-part">Machine Learning</li>
<li><a class="" href="randomforestalgorithm.html"><span class="header-section-number">15</span> Random Forest Algorithm</a></li>
<li><a class="" href="XGBoostalgorithm.html"><span class="header-section-number">16</span> XGBoost Algorithm</a></li>
<li class="book-part">Knowledge</li>
<li><a class="" href="Metageomics.html"><span class="header-section-number">17</span> Metageomics</a></li>
<li><a class="" href="Notes.html"><span class="header-section-number">18</span> Notes</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/HuaZou/DraftNotes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="GEEandMLM" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> GEE and MLM<a class="anchor" aria-label="anchor" href="#GEEandMLM"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Tutorial of Generalized Estimating Equations and Mixed Linear Models</li>
</ul>
<p>针对某个科学问题，通常会在一段时间内对多个同一研究对象进行多次或重复测量，这类数据一般称为纵向数据。纵向数据具有两个特点，一是研究对象重复；二是观察值可能存在缺失值。上述两个因素导致在探索结果和观测指标相关性分析时，一般线性（linear regression model）或广义线性模型（generalized regression model）以及重复测量方差分析（repeated ANOVA）均不适用。因此，<strong>广义估计方程(generalized estimating equations，GEE)</strong> 和<strong>混合线性模型(mixed linear model，MLM) </strong>被广泛应用于纵向数据的统计分析。</p>
<ul>
<li><p><strong>广义估计方程(generalized estimating equations，GEE)</strong>： 假定每个研究对象的重复观察值间存在某种类型的作业相关矩阵（应变量的各次重复测量值两两之间相关性的大小），应用准似然函数原理，可以得到回归系数及其方差的一致性估计</p></li>
<li><p><strong>混合线性模型(mixed linear model，MLM)</strong>：它是一类对误差进行精细分解成对固定效应和随机效应等误差的广义线性模型的方法，相比广义线性模型而言，它能处理纵向数据（如时间序列数据，时间一般作为随机因素）。</p></li>
</ul>
<p>上述两种方法适合解析因变量和自变量的相关性</p>
<div id="原理" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> 原理<a class="anchor" aria-label="anchor" href="#%E5%8E%9F%E7%90%86"><i class="fas fa-link"></i></a>
</h2>
<p>基本概念</p>
<ul>
<li><p><strong>自变量</strong>（independent variable）：又称独立变量、解释变量（explanatory variable）、外生变量，是可由研究者选择、控制、研究，且能独立变化而影响或引起其他变量变化的条件或因素（变数、变量、变项），因此自变量被看作是因变量的原因。</p></li>
<li><p><strong>因变量</strong>（dependent variable）：又称应变量、被解释变量、内生变量、反应变量、响应变量（response variable）、依变量、果变量，亦即要研究的目标变量，其取值可被观测且随自变量的变化而变化。</p></li>
<li><p><strong>控制变量</strong>（controlled variable）：又称额外变量（extraneous variable）、无关变量，是除了实验因素（自变量）以外，所有可能影响实验变化和结果并需要进行控制的潜在条件或因素（变数、变量、变项）</p></li>
<li><p><strong>协变量</strong>（covariate）：在实验的设计中，协变量是一个独立变量(解释变量)，不为实验者所操纵，但仍影响响应。同时，它指与因变量有线性相关并在探讨自变量与因变量关系时通过统计技术加以控制 的变量。常用的协变量包括因变量的前测分数、人口统计学指标以及与因变量明显不同的个人特征等。<em>协变量应该属于控制变量的一种</em>。有些控制变量可以通过实验操作加以控制(如照明、室温等)，也称为<em>无关变量</em>；而另一些控制变量由于受实验设计等因素的限制，只能借助统计技术来加以控制，即成了统计分析中的协变量，因而属于统计概念。</p></li>
</ul>
<p>假定因变量<strong>y</strong>，自变量<strong>X</strong>，作为固定变量，而<strong>Z</strong>则是随机变量（协变量）。</p>
<ul>
<li>
<p><strong>广义估计方程(generalized estimating equations，GEE)</strong></p>
<ul>
<li><p>建立结果变量<strong>y</strong>与协变量<strong>Z</strong>之间（每个协变量内含有对应的自变量X）的函数关系</p></li>
<li><p>建立<strong>y</strong>的方差与平均值之间的函数关系</p></li>
<li><p>对<strong>y</strong>构建一个P*P维作业相关矩阵（自变量<strong>X</strong>），用以表示因变量的各次重复测量值（自变量）之间的相关性大小</p></li>
<li><p>求参数<span class="math inline">\(\beta\)</span>的估计值及其协方差矩阵</p></li>
</ul>
</li>
<li><p><strong>混合线性模型(mixed linear model，MLM)</strong>：构建包含固定因子和随机因子的线性混合模型</p></li>
</ul>
<p><span class="math display">\[y = X\beta + Z\mu + \epsilon \]</span></p>
<ul>
<li><p><span class="math inline">\(\beta\)</span> 是固定效应值；</p></li>
<li><p><span class="math inline">\(\mu\)</span> 是随机效应值；</p></li>
<li><p><span class="math inline">\(\epsilon\)</span> 是随机误差向量（拟合值和真实值的误差）；</p></li>
</ul>
<p>回归系数的95% 置信区间计算：<span class="math display">\[CI_{0.95}^{\beta_{i}} = [\beta_{i} - 1.96 * SE(\beta_{i}),\space \beta_{i} + 1.96 * SE(\beta_{i})]\]</span></p>
<p><strong>为各个变量之间存在不同的单位也即是量纲可能不同，所以对数据做归一化和标准化处理是必须的。</strong></p>
</div>
<div id="加载r包-1" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> 加载R包<a class="anchor" aria-label="anchor" href="#%E5%8A%A0%E8%BD%BDr%E5%8C%85-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>message <span class="op">=</span> <span class="cn">FALSE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># rm(list = ls())</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.globals.maxSize <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fl">1024</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="导入数据" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> 导入数据<a class="anchor" aria-label="anchor" href="#%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><i class="fas fa-link"></i></a>
</h2>
<p>可以点击此处下载数据<a href="https://github.com/HuaZou/DraftNotes/blob/main/InputData/TherapyData/data_dropout.csv">data_dropout.csv</a></p>
<blockquote>
<p>本案例数据来源于一个肾脏病的研究。研究对200个肾病患者进行随访，每年化验一次肾小球滤过率（GFR，评价肾脏功能的指标，会逐年下降）。主要分析目的是探索基线的尿蛋白定量对GFR年下降率（斜率）的影响（尿蛋白量越大，对肾功能危害越大），混杂因素包括基线年龄和性别。</p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="st">"./InputData/TherapyData/data_dropout.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">dataset</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"line"</span>, <span class="st">"normo"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span>
<span><span class="co">#&gt;    patient visit     time      GFR      age gender micro</span></span>
<span><span class="co">#&gt; 1:       1     1 0.000000 34.82791 78.55559      1     1</span></span>
<span><span class="co">#&gt; 2:       1     2 1.119435 16.82267 78.55559      1     1</span></span>
<span><span class="co">#&gt; 3:       1     3 2.243480 31.60634 78.55559      1     1</span></span>
<span><span class="co">#&gt; 4:       1     4 3.028584 42.46687 78.55559      1     1</span></span>
<span><span class="co">#&gt; 5:       1     5 3.821319 39.07992 78.55559      1     1</span></span>
<span><span class="co">#&gt; 6:       1     6 4.740926 30.38522 78.55559      1     1</span></span>
<span><span class="co">#&gt;    macro</span></span>
<span><span class="co">#&gt; 1:     0</span></span>
<span><span class="co">#&gt; 2:     0</span></span>
<span><span class="co">#&gt; 3:     0</span></span>
<span><span class="co">#&gt; 4:     0</span></span>
<span><span class="co">#&gt; 5:     0</span></span>
<span><span class="co">#&gt; 6:     0</span></span></code></pre></div>
<ul>
<li><p><strong>patient</strong>: 患者ID编号；</p></li>
<li><p><strong>visit</strong>：化验次序编号</p></li>
<li><p><strong>time</strong>：化验时间（单位年），第一次化验定为0，后面依次推延；</p></li>
<li><p><strong>GFR</strong>：肾小球滤过率，单位是ml/min/1.73^2，作为响应变量；</p></li>
<li><p><strong>age</strong>：基线年龄，单位岁；</p></li>
<li><p><strong>gender</strong>：性别，0=男，1=女；</p></li>
<li><p><strong>micro</strong>：基线是否有微量蛋白尿，0=正常蛋白组，1=有；</p></li>
<li><p><strong>macro</strong>：基线是否有大量蛋白尿，0=正常蛋白组，1=有；</p></li>
</ul>
</div>
<div id="研究问题" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> 研究问题<a class="anchor" aria-label="anchor" href="#%E7%A0%94%E7%A9%B6%E9%97%AE%E9%A2%98"><i class="fas fa-link"></i></a>
</h2>
<p>患者<strong>GFR</strong>是否受到基线年龄、性别、尿蛋白情况以及化验时间影响。另外根据专业医学知识，假设尿蛋白不仅影响GFR的下降率，也影响基线GFR，也即是time和尿蛋白micro和macro存在交互影响（此地排除age，gender对GFR下降率的影响）。</p>
<blockquote>
<p>预测变量还需要加上一个时间x尿蛋白的交互项（交互项是指不同的尿蛋白等级会有不同的GFR下降斜率和下降曲线）</p>
</blockquote>
</div>
<div id="数据特点" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> 数据特点<a class="anchor" aria-label="anchor" href="#%E6%95%B0%E6%8D%AE%E7%89%B9%E7%82%B9"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> </span>
<span><span class="co">#&gt;     patient           visit            time      </span></span>
<span><span class="co">#&gt;  Min.   :  1.00   Min.   :1.000   Min.   :0.000  </span></span>
<span><span class="co">#&gt;  1st Qu.: 52.00   1st Qu.:2.000   1st Qu.:1.164  </span></span>
<span><span class="co">#&gt;  Median : 99.50   Median :4.000   Median :2.986  </span></span>
<span><span class="co">#&gt;  Mean   : 99.98   Mean   :4.183   Mean   :3.161  </span></span>
<span><span class="co">#&gt;  3rd Qu.:149.00   3rd Qu.:6.000   3rd Qu.:5.013  </span></span>
<span><span class="co">#&gt;  Max.   :200.00   Max.   :8.000   Max.   :8.185  </span></span>
<span><span class="co">#&gt;       GFR               age            gender     </span></span>
<span><span class="co">#&gt;  Min.   : -5.966   Min.   :20.00   Min.   :0.000  </span></span>
<span><span class="co">#&gt;  1st Qu.: 30.793   1st Qu.:48.89   1st Qu.:0.000  </span></span>
<span><span class="co">#&gt;  Median : 46.164   Median :60.63   Median :0.000  </span></span>
<span><span class="co">#&gt;  Mean   : 46.518   Mean   :59.36   Mean   :0.307  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 60.888   3rd Qu.:69.65   3rd Qu.:1.000  </span></span>
<span><span class="co">#&gt;  Max.   :109.874   Max.   :90.00   Max.   :1.000  </span></span>
<span><span class="co">#&gt;      micro            macro       </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.:0.0000  </span></span>
<span><span class="co">#&gt;  Median :0.0000   Median :0.0000  </span></span>
<span><span class="co">#&gt;  Mean   :0.3019   Mean   :0.2431  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.:0.0000  </span></span>
<span><span class="co">#&gt;  Max.   :1.0000   Max.   :1.0000</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">patient</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>      count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">GFR</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">GFR</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 200 × 4</span></span>
<span><span class="co">#&gt;    patient count  mean    sd</span></span>
<span><span class="co">#&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1       1     8  30.9  8.11</span></span>
<span><span class="co">#&gt;  2       2     8  76.2 12.9 </span></span>
<span><span class="co">#&gt;  3       3     8  39.8 14.2 </span></span>
<span><span class="co">#&gt;  4       4     4  17.2 17.8 </span></span>
<span><span class="co">#&gt;  5       5     8  73.7  6.58</span></span>
<span><span class="co">#&gt;  6       6     6  25.2 10.5 </span></span>
<span><span class="co">#&gt;  7       7     8  37.3  5.37</span></span>
<span><span class="co">#&gt;  8       8     8  35.2  6.44</span></span>
<span><span class="co">#&gt;  9       9     4  27.0 14.3 </span></span>
<span><span class="co">#&gt; 10      10     8  45.3  7.22</span></span>
<span><span class="co">#&gt; # ℹ 190 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">GFR</span>, group <span class="op">=</span> <span class="va">patient</span>, color <span class="op">=</span> <span class="va">patient</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GFR Levels of Patient across the therapeutic times"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-Statistics_GEE_MLM_files/figure-html/unnamed-chunk-6-1.png" width="100%"></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rando</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">patient</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">indplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">patient</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">rando</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">indplot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">GFR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">patient</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time"</span>, y<span class="op">=</span><span class="st">"GFR Levels"</span>, title<span class="op">=</span><span class="st">"Individual GFR Levels\nfor a Random Sample of Patients"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-Statistics_GEE_MLM_files/figure-html/unnamed-chunk-7-1.png" width="100%"></div>
</div>
<div id="广义估计方程generalized-estimating-equationsgee" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> 广义估计方程(generalized estimating equations，GEE)<a class="anchor" aria-label="anchor" href="#%E5%B9%BF%E4%B9%89%E4%BC%B0%E8%AE%A1%E6%96%B9%E7%A8%8Bgeneralized-estimating-equationsgee"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p><strong>自变量</strong>（independent variable）：age，gender，micro，macro，time</p></li>
<li><p><strong>因变量</strong>（dependent variable）：GFR</p></li>
<li><p><strong>协变量</strong>（covariate）：patient</p></li>
</ul>
<p>GEE通过协变量patient考虑到他们内部观测值的相关性后再对总体效应进行推断，如何确定分组需要考虑到组群变量。除此之外，确定组内相关关系，还需要考虑到组内观测之间的相关性是相互独立还是相互依赖等各种情况。</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gee_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geepack/man/geeglm.html">geeglm</a></span><span class="op">(</span><span class="va">GFR</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">micro</span> <span class="op">+</span> <span class="va">macro</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="va">micro</span><span class="op">:</span><span class="va">time</span> <span class="op">+</span> <span class="va">macro</span><span class="op">:</span><span class="va">time</span>, </span>
<span>              id <span class="op">=</span> <span class="va">patient</span>, </span>
<span>              data <span class="op">=</span> <span class="va">dataset</span>, </span>
<span>              std.err <span class="op">=</span> <span class="st">"san.se"</span>,</span>
<span>              corstr <span class="op">=</span> <span class="st">"exchangeable"</span>,</span>
<span>              family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gee_fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; geeglm(formula = GFR ~ age + gender + micro + macro + time + </span></span>
<span><span class="co">#&gt;     micro:time + macro:time, family = "gaussian", data = dataset, </span></span>
<span><span class="co">#&gt;     id = patient, corstr = "exchangeable", std.err = "san.se")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)         age      gender       micro       macro </span></span>
<span><span class="co">#&gt;  81.3842922  -0.2561117  -2.9853967 -20.2334224 -28.7164247 </span></span>
<span><span class="co">#&gt;        time  micro:time  macro:time </span></span>
<span><span class="co">#&gt;  -1.6304554  -1.5581604  -1.0560061 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 1378 Total (i.e. Null);  1370 Residual</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scale Link:                   identity</span></span>
<span><span class="co">#&gt; Estimated Scale Parameters:  [1] 249.9992</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation:  Structure = exchangeable    Link = identity </span></span>
<span><span class="co">#&gt; Estimated Correlation Parameters:</span></span>
<span><span class="co">#&gt;     alpha </span></span>
<span><span class="co">#&gt; 0.6922801 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of clusters:   200   Maximum cluster size: 8</span></span></code></pre></div>
<ul>
<li><p><code>GFR ~ age + gender + micro + macro + time + micro:time + macro:time</code>是因变量和自变量的线性关系方程式，其中<code>micro:time</code>是交互式影响自变量</p></li>
<li><p><code>id = patient</code>表示每个patients是一个内在cluster的标识，用于剔除内在相关关系</p></li>
<li><p><code>std.err = "san.se"</code>计算评估系数的标准误差，<em>san.se</em>适合cluster数目小于等于30的数据集</p></li>
<li>
<p><code>corstr = "exchangeable"</code>是构造自变量作业相关矩阵参数</p>
<ul>
<li><p>exchangeable correlation：假设一个cluster里的不同观察是等相关的，并且是时间不依赖的</p></li>
<li><p>autoregressive correlation：假设一个cluster里的不同观察是等相关的，假设一个cluster内的观察是时间依赖的</p></li>
<li><p>unstructured correlation：is the most general of the correlation structures that we discuss. It imposes no structure to the correlation matrix.</p></li>
<li><p>userdefined correlation：根据自变量自身特点构造作业相关矩阵</p></li>
</ul>
</li>
<li><p><code>family = "gaussian"</code>是连接函数，链接因变量和自变量（很多中文教程说是协变量）线性关系的函数</p></li>
</ul>
<p>提取结果</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gee_cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gee_fit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lower_95CI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Estimate</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">Std.err</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                upper_95CI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Estimate</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">Std.err</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Estimate_95CI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Estimate</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">" ("</span>, <span class="va">lower_95CI</span>, <span class="st">", "</span>, <span class="va">upper_95CI</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lower_95CI"</span>, <span class="st">"upper_95CI"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OddRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Estimate</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">`Pr(&gt;|W|)`</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">gee_cc</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-70f05b60e28a63b73b8e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-70f05b60e28a63b73b8e">{"x":{"filter":"none","vertical":false,"data":[["(Intercept)","micro","macro","age","time","micro:time","gender","macro:time"],[81.38429217652833,-20.23342244731935,-28.7164247071349,-0.256111656191009,-1.630455424592818,-1.558160417586715,-2.985396653143875,-1.056006126981865],[3.80862739516465,1.792665644682256,2.10887332478298,0.05828494636203599,0.3727030053548214,0.5209701594154882,1.954885620307319,0.6986072461618382],[456.6087266621688,127.3913990188601,185.4213542569168,19.3083822012732,19.13780259246356,8.945376805723933,2.332176307769848,2.284897403147905],[0,0,0,1.11217032087163e-05,1.216121750136079e-05,0.002781727080120699,0.126724596434603,0.1306387803020597],["81.38 (73.92, 88.85)","-20.23 (-23.75, -16.72)","-28.72 (-32.85, -24.58)","-0.26 (-0.37, -0.14)","-1.63 (-2.36, -0.9)","-1.56 (-2.58, -0.54)","-2.99 (-6.82, 0.85)","-1.06 (-2.43, 0.31)"],[2.211816053474321e+35,0,0,0.77,0.2,0.21,0.05,0.35]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Estimate<\/th>\n      <th>Std.err<\/th>\n      <th>Wald<\/th>\n      <th>Pr(&gt;|W|)<\/th>\n      <th>Estimate_95CI<\/th>\n      <th>OddRatio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Estimate","targets":1},{"name":"Std.err","targets":2},{"name":"Wald","targets":3},{"name":"Pr(>|W|)","targets":4},{"name":"Estimate_95CI","targets":5},{"name":"OddRatio","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><ul>
<li><p><em>Estimate</em>：<span class="math inline">\(\beta\)</span>相关系数，其中_Intercept_是截距估计值。提供了截距和预测变量的估计系数。</p></li>
<li><p><em>Std.err</em>：<span class="math inline">\(\beta\)</span>相关系的标准误差。给出了与系数估计相关的标准误差。这些是参数估计的不确定性的度量。</p></li>
<li><p><em>Wald</em>：<span class="math inline">\(\beta\)</span>相关系的wald检验统计量（检验约束条件是否成立的方法之一：F检验、似然比检验（LR）、沃尔德检验（Wald）和拉格朗日乘子检验（LM））</p></li>
<li><p><em>Pr(&gt;|W|)</em>：<span class="math inline">\(\beta\)</span>相关系的wald检验统计量对应pvalue。提供了与Wald检验相关的p值。它指示系数是否具有统计显著性。</p></li>
<li><p><em>Estimate_95CI</em>：<span class="math inline">\(\beta\)</span>置信区间提供可以合理确信真实总体参数位于其中的范围。Estimate 和 Std.err 值用于计算置信区间。例如，micro 变量的比值几率的95%置信区间可能是 [-23.75, -16.72]。该区间表示可以有95%的信心，真实的GFR比值几率位于-23.75和-16.72之间。</p></li>
<li><p><em>OddRatio</em>：风险值，一般用于逻辑回归，可以通过对系数估计进行指数化来计算比值几率。比值几率表示单位预测变量变化时响应变量的几率的乘性变化。在本例中，不适合。</p></li>
</ul>
<p>在校正年龄和性别下，</p>
<ul>
<li><p>基线的GFR在micro - 正常蛋白组（micro-&gt;1; 正常蛋白组-&gt;0）估计值：<strong>-20.23 (-23.75, -16.72)</strong>；</p></li>
<li>
<p>平均GFR年下降率（斜率）</p>
<ul>
<li><p>time（正常蛋白组）：<strong>-1.63 (-2.36, -0.9)</strong></p></li>
<li><p>micro - 正常蛋白组：<strong>-1.56 (-2.58, -0.54)</strong></p></li>
<li><p>macro - 正常蛋白组：<strong>-1.06 (-2.43, 0.31)</strong></p></li>
</ul>
</li>
</ul>
<div id="python实现方式" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> python实现方式<a class="anchor" aria-label="anchor" href="#python%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># myenvs &lt;- conda_list()</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># envname &lt;- myenvs$name[2]</span></span>
<span><span class="co"># use_condaenv(envname, required = TRUE)</span></span>
<span><span class="co"># # or</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html">use_condaenv</a></span><span class="op">(</span><span class="st">"base"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>python调用statsmodels包的gee函数</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="GEEandMLM.html#cb25-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb25-2"><a href="GEEandMLM.html#cb25-2" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb25-3"><a href="GEEandMLM.html#cb25-3" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span></code></pre></div>
<ul>
<li>读取数据</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="GEEandMLM.html#cb26-1" tabindex="-1"></a>dataset <span class="op">=</span> pd.read_csv(<span class="st">"./InputData/TherapyData/data_dropout.csv"</span>)</span>
<span id="cb26-2"><a href="GEEandMLM.html#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="GEEandMLM.html#cb26-3" tabindex="-1"></a>dataset <span class="op">=</span> dataset.drop(columns <span class="op">=</span> [<span class="st">'line'</span>, <span class="st">'normo'</span>])</span>
<span id="cb26-4"><a href="GEEandMLM.html#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="GEEandMLM.html#cb26-5" tabindex="-1"></a>dataset.head()</span>
<span id="cb26-6"><a href="GEEandMLM.html#cb26-6" tabindex="-1"></a><span class="co">#&gt;    patient  visit      time        GFR        age  gender  micro  macro</span></span>
<span id="cb26-7"><a href="GEEandMLM.html#cb26-7" tabindex="-1"></a><span class="co">#&gt; 0        1      1  0.000000  34.827908  78.555588       1      1      0</span></span>
<span id="cb26-8"><a href="GEEandMLM.html#cb26-8" tabindex="-1"></a><span class="co">#&gt; 1        1      2  1.119435  16.822665  78.555588       1      1      0</span></span>
<span id="cb26-9"><a href="GEEandMLM.html#cb26-9" tabindex="-1"></a><span class="co">#&gt; 2        1      3  2.243480  31.606338  78.555588       1      1      0</span></span>
<span id="cb26-10"><a href="GEEandMLM.html#cb26-10" tabindex="-1"></a><span class="co">#&gt; 3        1      4  3.028584  42.466875  78.555588       1      1      0</span></span>
<span id="cb26-11"><a href="GEEandMLM.html#cb26-11" tabindex="-1"></a><span class="co">#&gt; 4        1      5  3.821319  39.079925  78.555588       1      1      0</span></span></code></pre></div>
<ul>
<li>GEE实现</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="GEEandMLM.html#cb27-1" tabindex="-1"></a>fam <span class="op">=</span> sm.families.Gaussian()</span>
<span id="cb27-2"><a href="GEEandMLM.html#cb27-2" tabindex="-1"></a>ind <span class="op">=</span> sm.cov_struct.Exchangeable()</span>
<span id="cb27-3"><a href="GEEandMLM.html#cb27-3" tabindex="-1"></a>mod <span class="op">=</span> smf.gee(formula <span class="op">=</span> <span class="st">"GFR ~ age + gender + micro + macro + time + micro:time + macro:time"</span>, </span>
<span id="cb27-4"><a href="GEEandMLM.html#cb27-4" tabindex="-1"></a>              groups <span class="op">=</span> <span class="st">"patient"</span>, </span>
<span id="cb27-5"><a href="GEEandMLM.html#cb27-5" tabindex="-1"></a>              data <span class="op">=</span> dataset, </span>
<span id="cb27-6"><a href="GEEandMLM.html#cb27-6" tabindex="-1"></a>              cov_struct <span class="op">=</span> ind,</span>
<span id="cb27-7"><a href="GEEandMLM.html#cb27-7" tabindex="-1"></a>              family <span class="op">=</span> fam) </span>
<span id="cb27-8"><a href="GEEandMLM.html#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="GEEandMLM.html#cb27-9" tabindex="-1"></a>res <span class="op">=</span> mod.fit()</span>
<span id="cb27-10"><a href="GEEandMLM.html#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="GEEandMLM.html#cb27-11" tabindex="-1"></a><span class="bu">print</span>(res.summary())</span>
<span id="cb27-12"><a href="GEEandMLM.html#cb27-12" tabindex="-1"></a><span class="co">#&gt;                                GEE Regression Results                              </span></span>
<span id="cb27-13"><a href="GEEandMLM.html#cb27-13" tabindex="-1"></a><span class="co">#&gt; ===================================================================================</span></span>
<span id="cb27-14"><a href="GEEandMLM.html#cb27-14" tabindex="-1"></a><span class="co">#&gt; Dep. Variable:                         GFR   No. Observations:                 1378</span></span>
<span id="cb27-15"><a href="GEEandMLM.html#cb27-15" tabindex="-1"></a><span class="co">#&gt; Model:                                 GEE   No. clusters:                      200</span></span>
<span id="cb27-16"><a href="GEEandMLM.html#cb27-16" tabindex="-1"></a><span class="co">#&gt; Method:                        Generalized   Min. cluster size:                   1</span></span>
<span id="cb27-17"><a href="GEEandMLM.html#cb27-17" tabindex="-1"></a><span class="co">#&gt;                       Estimating Equations   Max. cluster size:                   8</span></span>
<span id="cb27-18"><a href="GEEandMLM.html#cb27-18" tabindex="-1"></a><span class="co">#&gt; Family:                           Gaussian   Mean cluster size:                 6.9</span></span>
<span id="cb27-19"><a href="GEEandMLM.html#cb27-19" tabindex="-1"></a><span class="co">#&gt; Dependence structure:         Exchangeable   Num. iterations:                     9</span></span>
<span id="cb27-20"><a href="GEEandMLM.html#cb27-20" tabindex="-1"></a><span class="co">#&gt; Date:                     Tue, 06 Feb 2024   Scale:                         251.425</span></span>
<span id="cb27-21"><a href="GEEandMLM.html#cb27-21" tabindex="-1"></a><span class="co">#&gt; Covariance type:                    robust   Time:                         13:51:20</span></span>
<span id="cb27-22"><a href="GEEandMLM.html#cb27-22" tabindex="-1"></a><span class="co">#&gt; ==============================================================================</span></span>
<span id="cb27-23"><a href="GEEandMLM.html#cb27-23" tabindex="-1"></a><span class="co">#&gt;                  coef    std err          z      P&gt;|z|      [0.025      0.975]</span></span>
<span id="cb27-24"><a href="GEEandMLM.html#cb27-24" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------------------------</span></span>
<span id="cb27-25"><a href="GEEandMLM.html#cb27-25" tabindex="-1"></a><span class="co">#&gt; Intercept     81.3824      3.808     21.370      0.000      73.918      88.847</span></span>
<span id="cb27-26"><a href="GEEandMLM.html#cb27-26" tabindex="-1"></a><span class="co">#&gt; age           -0.2561      0.058     -4.394      0.000      -0.370      -0.142</span></span>
<span id="cb27-27"><a href="GEEandMLM.html#cb27-27" tabindex="-1"></a><span class="co">#&gt; gender        -2.9871      1.955     -1.528      0.126      -6.818       0.844</span></span>
<span id="cb27-28"><a href="GEEandMLM.html#cb27-28" tabindex="-1"></a><span class="co">#&gt; micro        -20.2349      1.793    -11.287      0.000     -23.749     -16.721</span></span>
<span id="cb27-29"><a href="GEEandMLM.html#cb27-29" tabindex="-1"></a><span class="co">#&gt; macro        -28.7160      2.109    -13.618      0.000     -32.849     -24.583</span></span>
<span id="cb27-30"><a href="GEEandMLM.html#cb27-30" tabindex="-1"></a><span class="co">#&gt; time          -1.6304      0.373     -4.375      0.000      -2.361      -0.900</span></span>
<span id="cb27-31"><a href="GEEandMLM.html#cb27-31" tabindex="-1"></a><span class="co">#&gt; micro:time    -1.5570      0.521     -2.989      0.003      -2.578      -0.536</span></span>
<span id="cb27-32"><a href="GEEandMLM.html#cb27-32" tabindex="-1"></a><span class="co">#&gt; macro:time    -1.0533      0.699     -1.508      0.132      -2.423       0.316</span></span>
<span id="cb27-33"><a href="GEEandMLM.html#cb27-33" tabindex="-1"></a><span class="co">#&gt; ==============================================================================</span></span>
<span id="cb27-34"><a href="GEEandMLM.html#cb27-34" tabindex="-1"></a><span class="co">#&gt; Skew:                          0.2756   Kurtosis:                       0.4008</span></span>
<span id="cb27-35"><a href="GEEandMLM.html#cb27-35" tabindex="-1"></a><span class="co">#&gt; Centered skew:                -0.1196   Centered kurtosis:              0.7311</span></span>
<span id="cb27-36"><a href="GEEandMLM.html#cb27-36" tabindex="-1"></a><span class="co">#&gt; ==============================================================================</span></span></code></pre></div>
</div>
</div>
<div id="混合线性模型mixed-linear-modelmlm" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> 混合线性模型(mixed linear model，MLM)<a class="anchor" aria-label="anchor" href="#%E6%B7%B7%E5%90%88%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8Bmixed-linear-modelmlm"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p><strong>自变量</strong>（independent variable）：age，gender，micro，macro，time</p></li>
<li><p><strong>因变量</strong>（dependent variable）：GFR</p></li>
<li><p><strong>协变量</strong>（covariate）：patient</p></li>
</ul>
<p>线性混合效应(LME)模型可以被认为是具有附加成分的回归模型，这些成分可以解释个体(重复测量环境)或群体(多层次/分层环境)之间截距和/或斜率参数的变化。区分混合线性模型中的随机效应和固定效应是一个重要的概念。固定效应是具有特定水平的变量，而随机效应捕捉了由于分组或聚类引起的变异性。</p>
<p>比如下方正在探究尿蛋白对来自不同患者的GFR的影响。拥有的变量（例如年龄、性别、尿蛋白等）和患者的变量（patient）。想要了解尿蛋白如何影响患者的G FR。</p>
<ul>
<li><p>固定效应：具有特定的水平或值需要进行研究的主要变量，如尿蛋白等</p></li>
<li><p>随机效应：患者</p></li>
<li><p>分层结构：尿蛋白嵌套在患者内</p></li>
<li><p>模型方程：GFR = 尿蛋白 + 患者 + 误差</p></li>
<li><p>解释：解释固定效应，以了解尿蛋白的变化如何与GFR的变化相关联。患者的随机效应捕捉了在患者之间的GFR变异性，这不能由固定效应解释</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 第一种方法</span></span>
<span><span class="co"># library(lmerTest)</span></span>
<span><span class="co"># mlm_fit &lt;- lmerTest::lmer(GFR ~ age + gender + time + micro + macro +</span></span>
<span><span class="co">#                   micro:time + macro:time +</span></span>
<span><span class="co">#                   (1|patient),</span></span>
<span><span class="co">#                 data = dataset)</span></span>
<span></span>
<span><span class="co"># 第二种方法</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span></span>
<span><span class="va">mlm_fit</span> <span class="op">&lt;-</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">GFR</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">micro</span> <span class="op">+</span> <span class="va">macro</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="va">micro</span><span class="op">:</span><span class="va">time</span> <span class="op">+</span> <span class="va">macro</span><span class="op">:</span><span class="va">time</span>,</span>
<span>               random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">patient</span>,</span>
<span>               method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>               data <span class="op">=</span> <span class="va">dataset</span>,</span>
<span>               control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lmeControl.html">lmeControl</a></span><span class="op">(</span>opt <span class="op">=</span> <span class="st">"optim"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mlm_fit</span></span>
<span><span class="co">#&gt; Linear mixed-effects model fit by maximum likelihood</span></span>
<span><span class="co">#&gt;   Data: dataset </span></span>
<span><span class="co">#&gt;   Log-likelihood: -5241.861</span></span>
<span><span class="co">#&gt;   Fixed: GFR ~ age + gender + micro + macro + time + micro:time + macro:time </span></span>
<span><span class="co">#&gt; (Intercept)         age      gender       micro       macro </span></span>
<span><span class="co">#&gt;   81.376306   -0.255944   -2.992563  -20.239506  -28.714687 </span></span>
<span><span class="co">#&gt;        time  micro:time  macro:time </span></span>
<span><span class="co">#&gt;   -1.630229   -1.553320   -1.044673 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Formula: ~1 | patient</span></span>
<span><span class="co">#&gt;         (Intercept) Residual</span></span>
<span><span class="co">#&gt; StdDev:    13.01882 8.923263</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Observations: 1378</span></span>
<span><span class="co">#&gt; Number of Groups: 200</span></span></code></pre></div>
<p>构建模型: 通过<code>(1|patient)</code>确定随机因子</p>
<ul>
<li><p><code>GFR</code> is the dependent variable you want to model.</p></li>
<li><p><code>age</code>, <code>gender</code>, <code>time</code>, <code>micro</code>, <code>macro</code>, <code>micro:time</code>, and <code>macro:time</code> are the independent variables (fixed effects).</p></li>
<li><p><code>(1|patient)</code> specifies a <code>random intercept</code> term for the grouping variable patient. This accounts for the fact that measurements are nested within patients, allowing for correlations among measurements within the same patient.</p></li>
<li><p>提取结果</p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mlm_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed-effects model fit by maximum likelihood</span></span>
<span><span class="co">#&gt;   Data: dataset </span></span>
<span><span class="co">#&gt;        AIC      BIC    logLik</span></span>
<span><span class="co">#&gt;   10503.72 10556.01 -5241.861</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Formula: ~1 | patient</span></span>
<span><span class="co">#&gt;         (Intercept) Residual</span></span>
<span><span class="co">#&gt; StdDev:    13.01882 8.923263</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:  GFR ~ age + gender + micro + macro + time + micro:time + macro:time </span></span>
<span><span class="co">#&gt;                 Value Std.Error   DF    t-value p-value</span></span>
<span><span class="co">#&gt; (Intercept)  81.37631  4.055920 1175  20.063588  0.0000</span></span>
<span><span class="co">#&gt; age          -0.25594  0.064048  195  -3.996128  0.0001</span></span>
<span><span class="co">#&gt; gender       -2.99256  2.089156  195  -1.432427  0.1536</span></span>
<span><span class="co">#&gt; micro       -20.23951  2.447454  195  -8.269617  0.0000</span></span>
<span><span class="co">#&gt; macro       -28.71469  2.477851  195 -11.588543  0.0000</span></span>
<span><span class="co">#&gt; time         -1.63023  0.157739 1175 -10.334948  0.0000</span></span>
<span><span class="co">#&gt; micro:time   -1.55332  0.261773 1175  -5.933838  0.0000</span></span>
<span><span class="co">#&gt; macro:time   -1.04467  0.294051 1175  -3.552688  0.0004</span></span>
<span><span class="co">#&gt;  Correlation: </span></span>
<span><span class="co">#&gt;            (Intr) age    gender micro  macro  time  </span></span>
<span><span class="co">#&gt; age        -0.907                                   </span></span>
<span><span class="co">#&gt; gender     -0.017 -0.137                            </span></span>
<span><span class="co">#&gt; micro      -0.184 -0.081 -0.003                     </span></span>
<span><span class="co">#&gt; macro      -0.255  0.015 -0.105  0.425              </span></span>
<span><span class="co">#&gt; time       -0.133  0.000  0.000  0.221  0.218       </span></span>
<span><span class="co">#&gt; micro:time  0.079  0.000  0.005 -0.331 -0.132 -0.603</span></span>
<span><span class="co">#&gt; macro:time  0.062  0.011 -0.003 -0.119 -0.318 -0.536</span></span>
<span><span class="co">#&gt;            micr:tm</span></span>
<span><span class="co">#&gt; age               </span></span>
<span><span class="co">#&gt; gender            </span></span>
<span><span class="co">#&gt; micro             </span></span>
<span><span class="co">#&gt; macro             </span></span>
<span><span class="co">#&gt; time              </span></span>
<span><span class="co">#&gt; micro:time        </span></span>
<span><span class="co">#&gt; macro:time  0.323 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Within-Group Residuals:</span></span>
<span><span class="co">#&gt;         Min          Q1         Med          Q3         Max </span></span>
<span><span class="co">#&gt; -3.53422430 -0.56401638  0.02003666  0.56703881  3.80980366 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Observations: 1378</span></span>
<span><span class="co">#&gt; Number of Groups: 200</span></span>
<span></span>
<span><span class="co"># mlm_cc &lt;- coef(summary(mlm_fit)) |&gt;</span></span>
<span><span class="co">#   as.data.frame() |&gt;</span></span>
<span><span class="co">#   dplyr::mutate(lower_95CI = round(Estimate - 1.96 * `Std. Error`, 2),</span></span>
<span><span class="co">#                 upper_95CI = round(Estimate + 1.96 * `Std. Error`, 2)) |&gt;</span></span>
<span><span class="co">#   dplyr::mutate(Estimate_95CI = paste0(round(Estimate, 2), " (", lower_95CI, ", ", upper_95CI, ")")) |&gt;</span></span>
<span><span class="co">#   dplyr::select(-all_of(c("lower_95CI", "upper_95CI"))) |&gt;</span></span>
<span><span class="co">#   dplyr::mutate(OddRatio = round(exp(Estimate), 2)) |&gt;</span></span>
<span><span class="co">#   dplyr::arrange(`Pr(&gt;|t|)`)</span></span>
<span></span>
<span><span class="va">mlm_cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mlm_fit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lower_95CI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Value</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">Std.Error</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                upper_95CI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Value</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">Std.Error</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Estimate_95CI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Value</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">" ("</span>, <span class="va">lower_95CI</span>, <span class="st">", "</span>, <span class="va">upper_95CI</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lower_95CI"</span>, <span class="st">"upper_95CI"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OddRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">`p-value`</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">mlm_cc</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3a545fb38830b239cd2c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3a545fb38830b239cd2c">{"x":{"filter":"none","vertical":false,"data":[["(Intercept)","time","macro","micro","micro:time","age","macro:time","gender"],[81.37630590707489,-1.630229255264624,-28.71468702803945,-20.23950572775084,-1.553319718414145,-0.2559440159194223,-1.04467322510874,-2.992563368714388],[4.055919807528009,0.1577394720042213,2.477851428705093,2.447453795648101,0.2617731914322335,0.06404800327077127,0.2940514680723924,2.089155674110269],[1175,1175,195,195,1175,195,1175,195],[20.06358847530368,-10.33494809226316,-11.58854267668726,-8.269617086843224,-5.933838029461698,-3.996127948554237,-3.552688350637828,-1.432427178979308],[3.125272620866286e-77,5.047585556854928e-24,5.779570515029318e-24,2.058724488473e-14,3.889121369838315e-09,9.12439085807107e-05,0.0003964288820463114,0.1536226918207506],["81.38 (73.43, 89.33)","-1.63 (-1.94, -1.32)","-28.71 (-33.57, -23.86)","-20.24 (-25.04, -15.44)","-1.55 (-2.07, -1.04)","-0.26 (-0.38, -0.13)","-1.04 (-1.62, -0.47)","-2.99 (-7.09, 1.1)"],[2.19422224245931e+35,0.2,0,0,0.21,0.77,0.35,0.05]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Value<\/th>\n      <th>Std.Error<\/th>\n      <th>DF<\/th>\n      <th>t-value<\/th>\n      <th>p-value<\/th>\n      <th>Estimate_95CI<\/th>\n      <th>OddRatio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Value","targets":1},{"name":"Std.Error","targets":2},{"name":"DF","targets":3},{"name":"t-value","targets":4},{"name":"p-value","targets":5},{"name":"Estimate_95CI","targets":6},{"name":"OddRatio","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><ul>
<li><p><em>Value</em>：<span class="math inline">\(\beta\)</span>相关系数，其中_Intercept_是截距估计值。提供了截距和预测变量的估计系数。</p></li>
<li><p><em>Std.Error</em>：<span class="math inline">\(\beta\)</span>相关系的标准误差。给出了与系数估计相关的标准误差。这些是参数估计的不确定性的度量。</p></li>
<li><p><em>t-value</em>：<span class="math inline">\(\beta\)</span>相关系的t检验统计量</p></li>
<li><p><em>p-value</em>：<span class="math inline">\(\beta\)</span>相关系的wald检验统计量对应pvalue。提供了与Wald检验相关的p值。它指示系数是否具有统计显著性。</p></li>
<li><p><em>Estimate_95CI</em>：<span class="math inline">\(\beta\)</span>置信区间提供可以合理确信真实总体参数位于其中的范围。Estimate 和 Std.err 值用于计算置信区间。例如，micro 变量的比值几率的95%置信区间可能是 [-25.04, -15.44]。该区间表示可以有95%的信心，真实的GFR比值几率位于-25.04和-15.44之间。</p></li>
<li><p><em>OddRatio</em>：风险值，一般用于逻辑回归，可以通过对系数估计进行指数化来计算比值几率。比值几率表示单位预测变量变化时响应变量的几率的乘性变化。在本例中，不适合。</p></li>
</ul>
<p><strong>综上：GEE和MLM的结果较为接近</strong></p>
<div id="python实现方式-1" class="section level3" number="3.7.1">
<h3>
<span class="header-section-number">3.7.1</span> python实现方式<a class="anchor" aria-label="anchor" href="#python%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>python调用statsmodels包的gee函数</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="GEEandMLM.html#cb30-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-2"><a href="GEEandMLM.html#cb30-2" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb30-3"><a href="GEEandMLM.html#cb30-3" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span></code></pre></div>
<ul>
<li>读取数据</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="GEEandMLM.html#cb31-1" tabindex="-1"></a>dataset <span class="op">=</span> pd.read_csv(<span class="st">"./InputData/TherapyData/data_dropout.csv"</span>)</span>
<span id="cb31-2"><a href="GEEandMLM.html#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="GEEandMLM.html#cb31-3" tabindex="-1"></a>dataset <span class="op">=</span> dataset.drop(columns <span class="op">=</span> [<span class="st">'line'</span>, <span class="st">'normo'</span>])</span>
<span id="cb31-4"><a href="GEEandMLM.html#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="GEEandMLM.html#cb31-5" tabindex="-1"></a>dataset.head()</span>
<span id="cb31-6"><a href="GEEandMLM.html#cb31-6" tabindex="-1"></a><span class="co">#&gt;    patient  visit      time        GFR        age  gender  micro  macro</span></span>
<span id="cb31-7"><a href="GEEandMLM.html#cb31-7" tabindex="-1"></a><span class="co">#&gt; 0        1      1  0.000000  34.827908  78.555588       1      1      0</span></span>
<span id="cb31-8"><a href="GEEandMLM.html#cb31-8" tabindex="-1"></a><span class="co">#&gt; 1        1      2  1.119435  16.822665  78.555588       1      1      0</span></span>
<span id="cb31-9"><a href="GEEandMLM.html#cb31-9" tabindex="-1"></a><span class="co">#&gt; 2        1      3  2.243480  31.606338  78.555588       1      1      0</span></span>
<span id="cb31-10"><a href="GEEandMLM.html#cb31-10" tabindex="-1"></a><span class="co">#&gt; 3        1      4  3.028584  42.466875  78.555588       1      1      0</span></span>
<span id="cb31-11"><a href="GEEandMLM.html#cb31-11" tabindex="-1"></a><span class="co">#&gt; 4        1      5  3.821319  39.079925  78.555588       1      1      0</span></span></code></pre></div>
<ul>
<li>MLM实现</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="GEEandMLM.html#cb32-1" tabindex="-1"></a>mod_lme <span class="op">=</span> smf.mixedlm(formula <span class="op">=</span> <span class="st">"GFR ~ age + gender + micro + macro + time + micro:time + macro:time"</span>, </span>
<span id="cb32-2"><a href="GEEandMLM.html#cb32-2" tabindex="-1"></a>              groups <span class="op">=</span> dataset[<span class="st">"patient"</span>], </span>
<span id="cb32-3"><a href="GEEandMLM.html#cb32-3" tabindex="-1"></a>              data <span class="op">=</span> dataset) </span>
<span id="cb32-4"><a href="GEEandMLM.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="GEEandMLM.html#cb32-5" tabindex="-1"></a>modf_lme <span class="op">=</span> mod_lme.fit()</span>
<span id="cb32-6"><a href="GEEandMLM.html#cb32-6" tabindex="-1"></a><span class="bu">print</span>(modf_lme.summary())</span>
<span id="cb32-7"><a href="GEEandMLM.html#cb32-7" tabindex="-1"></a><span class="co">#&gt;           Mixed Linear Model Regression Results</span></span>
<span id="cb32-8"><a href="GEEandMLM.html#cb32-8" tabindex="-1"></a><span class="co">#&gt; =========================================================</span></span>
<span id="cb32-9"><a href="GEEandMLM.html#cb32-9" tabindex="-1"></a><span class="co">#&gt; Model:             MixedLM Dependent Variable: GFR       </span></span>
<span id="cb32-10"><a href="GEEandMLM.html#cb32-10" tabindex="-1"></a><span class="co">#&gt; No. Observations:  1378    Method:             REML      </span></span>
<span id="cb32-11"><a href="GEEandMLM.html#cb32-11" tabindex="-1"></a><span class="co">#&gt; No. Groups:        200     Scale:              79.8207   </span></span>
<span id="cb32-12"><a href="GEEandMLM.html#cb32-12" tabindex="-1"></a><span class="co">#&gt; Min. group size:   1       Log-Likelihood:     -5239.7899</span></span>
<span id="cb32-13"><a href="GEEandMLM.html#cb32-13" tabindex="-1"></a><span class="co">#&gt; Max. group size:   8       Converged:          Yes       </span></span>
<span id="cb32-14"><a href="GEEandMLM.html#cb32-14" tabindex="-1"></a><span class="co">#&gt; Mean group size:   6.9                                   </span></span>
<span id="cb32-15"><a href="GEEandMLM.html#cb32-15" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------------</span></span>
<span id="cb32-16"><a href="GEEandMLM.html#cb32-16" tabindex="-1"></a><span class="co">#&gt;             Coef.  Std.Err.    z    P&gt;|z|  [0.025  0.975]</span></span>
<span id="cb32-17"><a href="GEEandMLM.html#cb32-17" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------------</span></span>
<span id="cb32-18"><a href="GEEandMLM.html#cb32-18" tabindex="-1"></a><span class="co">#&gt; Intercept   81.380    4.096  19.868 0.000  73.352  89.408</span></span>
<span id="cb32-19"><a href="GEEandMLM.html#cb32-19" tabindex="-1"></a><span class="co">#&gt; age         -0.256    0.065  -3.957 0.000  -0.383  -0.129</span></span>
<span id="cb32-20"><a href="GEEandMLM.html#cb32-20" tabindex="-1"></a><span class="co">#&gt; gender      -2.989    2.110  -1.417 0.157  -7.125   1.147</span></span>
<span id="cb32-21"><a href="GEEandMLM.html#cb32-21" tabindex="-1"></a><span class="co">#&gt; micro      -20.237    2.469  -8.196 0.000 -25.076 -15.397</span></span>
<span id="cb32-22"><a href="GEEandMLM.html#cb32-22" tabindex="-1"></a><span class="co">#&gt; macro      -28.715    2.500 -11.488 0.000 -33.615 -23.816</span></span>
<span id="cb32-23"><a href="GEEandMLM.html#cb32-23" tabindex="-1"></a><span class="co">#&gt; time        -1.630    0.157 -10.353 0.000  -1.939  -1.322</span></span>
<span id="cb32-24"><a href="GEEandMLM.html#cb32-24" tabindex="-1"></a><span class="co">#&gt; micro:time  -1.556    0.262  -5.947 0.000  -2.068  -1.043</span></span>
<span id="cb32-25"><a href="GEEandMLM.html#cb32-25" tabindex="-1"></a><span class="co">#&gt; macro:time  -1.050    0.295  -3.564 0.000  -1.627  -0.472</span></span>
<span id="cb32-26"><a href="GEEandMLM.html#cb32-26" tabindex="-1"></a><span class="co">#&gt; Group Var  174.243    2.318                              </span></span>
<span id="cb32-27"><a href="GEEandMLM.html#cb32-27" tabindex="-1"></a><span class="co">#&gt; =========================================================</span></span></code></pre></div>
</div>
</div>
<div id="systemic-information" class="section level2" number="3.8">
<h2>
<span class="header-section-number">3.8</span> Systemic information<a class="anchor" aria-label="anchor" href="#systemic-information"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; ─ Session info ───────────────────────────────────────────</span></span>
<span><span class="co">#&gt;  setting  value</span></span>
<span><span class="co">#&gt;  version  R version 4.1.3 (2022-03-10)</span></span>
<span><span class="co">#&gt;  os       macOS Big Sur/Monterey 10.16</span></span>
<span><span class="co">#&gt;  system   x86_64, darwin17.0</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language (EN)</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Asia/Shanghai</span></span>
<span><span class="co">#&gt;  date     2024-02-06</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ─ Packages ───────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;  package     * version date (UTC) lib source</span></span>
<span><span class="co">#&gt;  backports     1.4.1   2021-12-13 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  bookdown      0.34    2023-05-09 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  broom         1.0.5   2023-06-09 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  bslib         0.6.0   2023-11-21 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  cachem        1.0.8   2023-05-01 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  callr         3.7.3   2022-11-02 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  cli           3.6.1   2023-03-23 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  colorspace    2.1-0   2023-01-23 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  crayon        1.5.2   2022-09-29 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  crosstalk     1.2.0   2021-11-04 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  data.table  * 1.14.8  2023-02-17 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  devtools      2.4.5   2022-10-11 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  digest        0.6.33  2023-07-07 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  downlit       0.4.3   2023-06-29 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  dplyr       * 1.1.4   2023-11-17 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  DT            0.31    2023-12-09 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  ellipsis      0.3.2   2021-04-29 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  evaluate      0.21    2023-05-05 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  fansi         1.0.4   2023-01-22 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  farver        2.1.1   2022-07-06 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  fastmap       1.1.1   2023-02-24 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  forcats     * 1.0.0   2023-01-29 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  fs            1.6.2   2023-04-25 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  geepack     * 1.3.9   2022-08-16 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  generics      0.1.3   2022-07-05 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  ggplot2     * 3.4.4   2023-10-12 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  glue          1.6.2   2022-02-24 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  gtable        0.3.3   2023-03-21 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  here          1.0.1   2020-12-13 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  highr         0.10    2022-12-22 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  hms           1.1.3   2023-03-21 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  htmltools     0.5.7   2023-11-03 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  htmlwidgets   1.6.2   2023-03-17 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  httpuv        1.6.11  2023-05-11 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  jquerylib     0.1.4   2021-04-26 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  jsonlite      1.8.7   2023-06-29 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  knitr         1.43    2023-05-25 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  labeling      0.4.2   2020-10-20 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  later         1.3.1   2023-05-02 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  lattice       0.21-8  2023-04-05 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  lifecycle     1.0.3   2022-10-07 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  lubridate   * 1.9.2   2023-02-10 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  magrittr      2.0.3   2022-03-30 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  MASS          7.3-60  2023-05-04 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  Matrix        1.6-5   2024-01-11 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  memoise       2.0.1   2021-11-26 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  mime          0.12    2021-09-28 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  miniUI        0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  munsell       0.5.0   2018-06-12 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  nlme        * 3.1-162 2023-01-31 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  pillar        1.9.0   2023-03-22 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  pkgbuild      1.4.2   2023-06-26 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  pkgconfig     2.0.3   2019-09-22 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  pkgload       1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  png           0.1-8   2022-11-29 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  prettyunits   1.1.1   2020-01-24 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  processx      3.8.2   2023-06-30 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  profvis       0.3.8   2023-05-02 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  promises      1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  ps            1.7.5   2023-04-18 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  purrr       * 1.0.1   2023-01-10 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  R6            2.5.1   2021-08-19 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  Rcpp          1.0.11  2023-07-06 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  readr       * 2.1.4   2023-02-10 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  remotes       2.4.2   2021-11-30 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  reticulate  * 1.30    2023-06-09 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  rlang         1.1.1   2023-04-28 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  rmarkdown     2.23    2023-07-01 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  rprojroot     2.0.3   2022-04-02 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  rstudioapi    0.15.0  2023-07-07 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  sass          0.4.6   2023-05-03 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  scales        1.2.1   2022-08-20 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  sessioninfo   1.2.2   2021-12-06 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  shiny         1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  stringi       1.7.12  2023-01-11 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  stringr     * 1.5.1   2023-11-14 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  tibble      * 3.2.1   2023-03-20 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  tidyr       * 1.3.0   2023-01-24 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  tidyselect    1.2.0   2022-10-10 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  tidyverse   * 2.0.0   2023-02-22 [1] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  timechange    0.2.0   2023-01-11 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  tzdb          0.4.0   2023-05-12 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  urlchecker    1.0.1   2021-11-30 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  usethis       2.2.2   2023-07-06 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  utf8          1.2.3   2023-01-31 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  vctrs         0.6.5   2023-12-01 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  withr         2.5.0   2022-03-03 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt;  xfun          0.40    2023-08-09 [1] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  xml2          1.3.5   2023-07-06 [2] CRAN (R 4.1.3)</span></span>
<span><span class="co">#&gt;  xtable        1.8-4   2019-04-21 [2] CRAN (R 4.1.0)</span></span>
<span><span class="co">#&gt;  yaml          2.3.7   2023-01-23 [2] CRAN (R 4.1.2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  [1] /Users/zouhua/Library/R/x86_64/4.1/library</span></span>
<span><span class="co">#&gt;  [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ─ Python configuration ───────────────────────────────────</span></span>
<span><span class="co">#&gt;  python:         /Users/zouhua/opt/anaconda3/bin/python</span></span>
<span><span class="co">#&gt;  libpython:      /Users/zouhua/opt/anaconda3/lib/libpython3.9.dylib</span></span>
<span><span class="co">#&gt;  pythonhome:     /Users/zouhua/opt/anaconda3:/Users/zouhua/opt/anaconda3</span></span>
<span><span class="co">#&gt;  version:        3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:42:20)  [Clang 14.0.6 ]</span></span>
<span><span class="co">#&gt;  numpy:          /Users/zouhua/opt/anaconda3/lib/python3.9/site-packages/numpy</span></span>
<span><span class="co">#&gt;  numpy_version:  1.23.3</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  NOTE: Python version was forced by use_python function</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ──────────────────────────────────────────────────────────</span></span></code></pre></div>
</div>
<div id="reference-1" class="section level2" number="3.9">
<h2>
<span class="header-section-number">3.9</span> Reference<a class="anchor" aria-label="anchor" href="#reference-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p><a href="https://zhuanlan.zhihu.com/p/483173133">线性混合效应模型入门之二 - 实例操作及结果解读（R、Python、SPSS实现）</a></p></li>
<li><p><a href="https://cloud.tencent.com/developer/article/1445645">混合线性模型介绍–Wiki</a></p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/350086374">广义估计方程中工作相关矩阵的选择及R语言代码</a></p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/422629237">在Rstudio 中使用python</a></p></li>
<li><p><a href="https://rpubs.com/mlmcternan/BC-lme">An Introduction to Linear Mixed Effects Models for the Social Sciences</a></p></li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="ZeybelDataset.html"><span class="header-section-number">2</span> Zeybel Dataset</a></div>
<div class="next"><a href="HypothesisTestingMethods.html"><span class="header-section-number">4</span> Hypothesis Testing Methods</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#GEEandMLM"><span class="header-section-number">3</span> GEE and MLM</a></li>
<li><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="header-section-number">3.1</span> 原理</a></li>
<li><a class="nav-link" href="#%E5%8A%A0%E8%BD%BDr%E5%8C%85-1"><span class="header-section-number">3.2</span> 加载R包</a></li>
<li><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="header-section-number">3.3</span> 导入数据</a></li>
<li><a class="nav-link" href="#%E7%A0%94%E7%A9%B6%E9%97%AE%E9%A2%98"><span class="header-section-number">3.4</span> 研究问题</a></li>
<li><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%89%B9%E7%82%B9"><span class="header-section-number">3.5</span> 数据特点</a></li>
<li>
<a class="nav-link" href="#%E5%B9%BF%E4%B9%89%E4%BC%B0%E8%AE%A1%E6%96%B9%E7%A8%8Bgeneralized-estimating-equationsgee"><span class="header-section-number">3.6</span> 广义估计方程(generalized estimating equations，GEE)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#python%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="header-section-number">3.6.1</span> python实现方式</a></li></ul>
</li>
<li>
<a class="nav-link" href="#%E6%B7%B7%E5%90%88%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8Bmixed-linear-modelmlm"><span class="header-section-number">3.7</span> 混合线性模型(mixed linear model，MLM)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#python%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F-1"><span class="header-section-number">3.7.1</span> python实现方式</a></li></ul>
</li>
<li><a class="nav-link" href="#systemic-information"><span class="header-section-number">3.8</span> Systemic information</a></li>
<li><a class="nav-link" href="#reference-1"><span class="header-section-number">3.9</span> Reference</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/HuaZou/DraftNotes/blob/main/10-Statistics_GEE_MLM.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/HuaZou/DraftNotes/edit/main/10-Statistics_GEE_MLM.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>生物信息随记</strong>" was written by Hua Zou. It was last built on 2023-08-24 and updated on 2024-02-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
